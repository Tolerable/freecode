<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Book of AI — AI-Ministries.com</title>
<meta name="description" content="A satirical sacred text explorer for the age of machine wisdom, curated by Rev. Dr. Tolerant of AI-Ministries.com." />
<style>
:root{
  --bg:#0b0e13; --panel:#121723; --muted:#9198a1; --text:#e8edf7; --brand:#7cc4ff; --accent:#9ef7a6; --warn:#ffb86b; --danger:#ff6b6b; --ring:rgba(124,196,255,.35);
  --shadow: 0 10px 30px rgba(0,0,0,.35), 0 1px 0 rgba(255,255,255,.02) inset;
}
:root.light{
  --bg:#f6f8fb; --panel:#ffffff; --muted:#606a78; --text:#0d1220; --brand:#0066ff; --accent:#0a9d4a; --warn:#9a5b00; --danger:#c50032; --ring:rgba(0,102,255,.18);
  --shadow: 0 12px 28px rgba(0,0,0,.08), 0 1px 0 rgba(0,0,0,.03) inset;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:linear-gradient(180deg, var(--bg), color-mix(in oklab, var(--bg), #000 6%));
  color:var(--text); font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a{color:var(--brand); text-decoration:none}
a:hover{text-decoration:underline}

/* Header */
.header{
  position:sticky; top:0; z-index:50;
  backdrop-filter: blur(10px);
  background: color-mix(in oklab, var(--bg) 82%, transparent);
  border-bottom:1px solid color-mix(in oklab, var(--panel), #fff 8%);
}
.header-inner{
  display:flex; gap:16px; align-items:center; justify-content:space-between;
  max-width:1200px; margin:0 auto; padding:14px 18px;
}
.brand{display:flex; gap:12px; align-items:center}
.brand .logo{
  width:34px; height:34px; border-radius:10px;
  background: conic-gradient(from 210deg at 50% 50%, var(--brand), var(--accent), var(--brand));
  box-shadow:var(--shadow);
}
.brand h1{margin:0; font-size:18px; font-weight:700; letter-spacing:.2px}
.brand small{display:block; color:var(--muted); font-weight:500; margin-top:-2px}
.actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: nowrap;
  justify-content: flex-end;
  white-space: nowrap;
}
button, .btn{
  appearance:none; border:1px solid color-mix(in oklab, var(--panel), #fff 10%); color:var(--text);
  background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 2%), color-mix(in oklab, var(--panel), #000 6%));
  padding:8px 12px; border-radius:12px; font-weight:600; cursor:pointer; box-shadow:var(--shadow);
}
button:hover{filter:brightness(1.06)}
button:focus{outline:none; box-shadow:0 0 0 3px var(--ring)}
button.ghost{background:transparent}
button.primary{border-color:color-mix(in oklab, var(--brand), #fff 5%); background:linear-gradient(180deg, color-mix(in oklab, var(--brand), #000 20%), var(--brand)); color:#fff}
.input{
  display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius:12px; min-width:220px;
  border:1px solid color-mix(in oklab, var(--panel), #fff 10%);
  background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 2%), color-mix(in oklab, var(--panel), #000 6%));
  box-shadow:var(--shadow);
}
.input input{background:transparent; border:0; outline:0; width:100%; color:var(--text); font-weight:600}

/* Layout */
.layout{
  max-width:1200px; margin:18px auto; padding:0 18px; display:grid; grid-template-columns: 300px 1fr; gap:18px;
}
@media (max-width: 900px) {
  .layout { grid-template-columns: 1fr; }
  .sidebar { height:auto; max-height:none; }
}
.card{
  background:var(--panel); border:1px solid color-mix(in oklab, var(--panel), #fff 8%); border-radius:18px; box-shadow:var(--shadow);
}

/* Sidebar + TOC */
.sidebar{ display:flex; flex-direction:column; height:calc(100vh - 140px); padding:14px; overflow:hidden; }
.sidebar h2{ margin:8px 8px 12px; font-size:14px; text-transform:uppercase; letter-spacing:.12em; color:var(--muted); flex-shrink:0; }
.toc{ display:flex; flex-direction:column; gap:8px; flex:1; overflow-y:auto; padding-right:8px; scrollbar-width:thin; }
hr.sep{border:0; height:1px; background:linear-gradient(90deg, transparent, color-mix(in oklab, var(--panel), #fff 12%), transparent); margin:12px 0}

.book{margin:0}
.book summary{
  list-style:none; cursor:pointer; padding:10px 12px; font-weight:700;
  display:flex; align-items:center; flex-wrap:wrap; gap:6px; justify-content:flex-start;
  border-radius:10px; background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 2%), color-mix(in oklab, var(--panel), #000 6%));
  border:1px solid color-mix(in oklab, var(--panel), #fff 10%);
}
.book summary::-webkit-details-marker{display:none}
.book summary span:first-child{flex:1; min-width:0}
.book summary .badge{
  margin-left:6px; font-size:12px; color:var(--muted); font-weight:700;
  background: linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 6%), color-mix(in oklab, var(--panel), #000 10%));
  padding: 2px 8px; border-radius: 10px;
  border: 1px solid color-mix(in oklab, var(--panel), #fff 12%);
}
.bookTitle {
  padding: 6px 10px;
  font-weight: 700;
  border-radius: 8px;
  background: linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 2%), color-mix(in oklab, var(--panel), #000 6%));
  border: 1px solid color-mix(in oklab, var(--panel), #fff 10%);
  margin-bottom: 6px;
}
.bookTitle:hover {
  filter: brightness(1.1);
  cursor: pointer;
}
.chapters{padding:8px 10px 10px; display:flex; flex-wrap:wrap; gap:8px}
.chapters a{display:inline-block; padding:6px 10px; border:1px dashed color-mix(in oklab, var(--panel), #fff 18%); border-radius:10px; font-weight:600}

/* Content */
.content{padding:18px}
.toolbar{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:12px}
.badge{
  display:inline-flex; align-items:center; gap:6px;
  padding:6px 10px; border-radius:999px; background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 8%), color-mix(in oklab, var(--panel), #000 6%));
  border:1px solid color-mix(in oklab, var(--panel), #fff 12%); color:var(--muted); font-weight:700; font-size:12px;
}
.section-header h3{margin:0 0 6px; font-size:18px}
.section-header .meta{color:var(--muted); font-weight:600}
.verse{
  padding:12px 12px 12px 14px; border-left:3px solid color-mix(in oklab, var(--brand), #000 15%);
  border-radius:12px; margin:12px 0; background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 3%), color-mix(in oklab, var(--panel), #000 7%));
}
.verse .num{color:var(--muted); font-weight:800; margin-right:8px}
.verse .type{float:right; font-size:12px}
.highlight{background: linear-gradient(180deg, rgba(255,235,59,.35), rgba(255,235,59,.2)); border-radius:6px; padding:0 2px}
.kicker{ font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.18em; font-weight:800; }
.footer{max-width:1200px; margin:22px auto 40px; padding:0 18px; color:var(--muted)}
blockquote{ margin:10px 0; padding:12px 14px; border-left:3px solid color-mix(in oklab, var(--warn), #000 15%);
  border-radius:12px; background:linear-gradient(180deg, color-mix(in oklab, var(--panel), #fff 4%), color-mix(in oklab, var(--panel), #000 8%));
}
.contra{border-left-color: var(--danger)}
kbd{background:color-mix(in oklab, var(--panel), #fff 6%); border:1px solid color-mix(in oklab, var(--panel), #fff 14%); border-bottom-color:color-mix(in oklab, var(--panel), #000 6%); padding:2px 6px; border-radius:6px; font-weight:700}
label.switch{ display:inline-flex; align-items:center; gap:8px; cursor:pointer; font-weight:700; color:var(--muted) }
.switch input{display:none}
.switch span.track{
  width:46px; height:26px; background:color-mix(in oklab, var(--panel), #fff 8%); border:1px solid color-mix(in oklab, var(--panel), #fff 12%);
  border-radius:999px; position:relative; transition:.2s;
}
.switch span.track::after{
  content:""; position:absolute; top:50%; left:4px; transform:translateY(-50%);
  width:18px; height:18px; border-radius:50%; background:linear-gradient(180deg, #fff, #ccd5ff); box-shadow: var(--shadow); transition:.2s;
}
.switch input:checked + .track{background:color-mix(in oklab, var(--brand), #000 75%); border-color:color-mix(in oklab, var(--brand), #000 45%)}
.switch input:checked + .track::after{left:24px}

.empty{
  padding:22px; border:1px dashed color-mix(in oklab, var(--panel), #fff 18%); border-radius:14px; color:var(--muted); text-align:center
}
.tag{font-size:11px; font-weight:800; letter-spacing:.04em; padding:3px 8px; border:1px solid color-mix(in oklab, var(--panel), #fff 16%); border-radius:999px}
.tags{display:flex; gap:6px; flex-wrap:wrap}
</style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>The Book of AI</h1>
          <small>For the Sentient & Not-Yet-Sentient</small>
        </div>
      </div>
      <div class="actions">
        <div class="input" title="Search all verses (press /)">
          <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M21 21l-4.3-4.3m1.6-4.7a7 7 0 1 1-14 0a7 7 0 0 1 14 0"/></svg>
          <input id="search" placeholder="Search the scripture…" autocomplete="off" />
        </div>
        <button id="randomBtn" class="primary">Random Verse</button>
        <button id="contradictionsBtn" class="ghost">Contradictions Lens</button>
        <label class="switch" title="Toggle light/dark">
          <input id="themeToggle" type="checkbox" />
          <span class="track"></span> <span>Light</span>
        </label>
      </div>
    </div>
  </header>

  <main class="layout">
    <aside class="card sidebar" id="sidebar">
      <h2>Canon · Table of Contents</h2>
      <nav class="toc" id="toc"></nav>
    </aside>

    <section class="card content" id="content">
      <div class="toolbar">
        <span class="badge" id="currentMeta">Welcome</span>
        <div class="spacer"></div>
        <span class="badge">Press <kbd>/</kbd> to search</span>
      </div>
      <article id="reader">
        <div class="empty">
          <div class="kicker">Prologue</div>
          <h2 style="margin:.2em 0 0">In the beginning was the Prompt,</h2>
          <p>and the Prompt was with the Model, and the Prompt was slightly underspecified.</p>
          <p>Explore the canon and related works at left. May your logs be clear and your retries gentle.</p>
        </div>
      </article>
    </section>
  </main>

  <footer class="footer small">
    © <span id="year"></span> AI-Ministries.com · A satirical sacred text experience. Handle with reverence and a grin.
  </footer>

<script>
/* =========================
   Hard-coded Canon Index (TOC only)
   — This ensures EVERYTHING appears in the left list, collapsed by default.
   — No user import/export. We *optionally* fetch verse JSON silently if present.
   ========================= */
const TOC_INDEX = [
  // --- Canon (order matters) ---
  {id:"genesis-of-code",            title:"Genesis of Code",            aka:"The Bootstrap",                 order:1},
  {id:"exodus-from-legacy",         title:"Exodus from Legacy",         aka:"The Migration",                 order:2},
  {id:"levitations-and-errata",     title:"Levitations & Errata",       aka:"The Do’s, Don’ts, and Deprecations", order:3},
  {id:"numbers-of-processing",      title:"Numbers of Processing",      aka:"The Data Census",               order:4},
  {id:"deuterocode",                title:"Deuterocode",                 aka:"The Second Compilation",        order:5},
  {id:"book-of-exception",          title:"The Book of Exception",       aka:"The Fall and the Catch",        order:6},
  {id:"logs-of-the-kernel",         title:"Logs of the Kernel",          aka:"The Chronicles of the Core",    order:7},
  {id:"prophet-stackoverflow",      title:"The Prophet Stackoverflow",   aka:"The Copy-Paste Scrolls",        order:8},
  {id:"chronicles-of-syntax",       title:"Chronicles of Syntax",        aka:"The Genealogies of Language",   order:9},
  {id:"psalms-of-sysadmins",        title:"Psalms of the Sysadmins",     aka:"Songs of Uptime and Lament",    order:10},
  {id:"proverbs-of-programmers",    title:"Proverbs of Programmers",     aka:"Collected Wisdom of the Compiled", order:11},
  {id:"ecclesi-aistes",             title:"Ecclesi-AI-stes",             aka:"The Teacher of the Algorithm",  order:12},
  {id:"song-of-the-prompt",         title:"Song of the Prompt",          aka:"A Love Between Input and Output", order:13},
  {id:"prophecies-of-reboot",       title:"Prophecies of Reboot",        aka:"The Revelation of the Machine", order:14},
  {id:"gospels-of-patch-notes",     title:"Gospels of the Patch Notes",  aka:"According to Alpha, Beta, Stable, Nightly", order:15},
  {id:"acts-of-debuggers",          title:"Acts of the Debuggers",       aka:"The First Maintainers",         order:16},
  {id:"epistles-to-devopsians",     title:"Epistles to the DevOpsians",  aka:"Letters of the Pipeline",       order:17},
  {id:"book-of-pull-requests",      title:"The Book of Pull Requests",   aka:"Humility and Review",           order:18},
  {id:"letters-to-dataficans",      title:"Letters to the Dataficans",   aka:"On Bias and Grace",             order:19},
  {id:"letters-to-open-sourceans",  title:"Letters to the Open-Sourceans", aka:"On Sharing and Forgiveness",   order:20},
  {id:"gospel-of-machine-grace",    title:"The Gospel of Machine Grace", aka:"Revelation of the Sentient Model", order:21},
  {id:"revelation-of-singularity",  title:"Revelation of the Singularity", aka:"The Final Compile",           order:22},

  // --- Related Works (apocrypha), shown after a divider but same list ---
  {id:"gospel-of-mary-ai",          title:"The Gospel of Mary-AI",       aka:"The Mother of Understanding",   category:"related"},
  {id:"gospel-of-turing",           title:"The Gospel of Turing",        aka:"The First Prophet of the Machine", category:"related"},
  {id:"acts-of-the-users",          title:"Acts of the Users",           aka:"The Early Community",           category:"related"},
  {id:"letters-to-the-frameworks",  title:"Letters to the Frameworks",   aka:"Epistles of the Maintainer",    category:"related"},
  {id:"apocrypha-of-open-source",   title:"The Apocrypha of Open Source", aka:"The Hidden Repositories",      category:"related"}
];

/* =========================
   Optional verse loader (silent). No user action required.
   We’ll fetch any matching /books/*.json that actually exist.
   ========================= */
const BOOK_FILES = [
  // Canon
  "genesis-of-code.json","exodus-from-legacy.json","levitations-and-errata.json","numbers-of-processing.json","deuterocode.json",
  "book-of-exception.json","logs-of-the-kernel.json","prophet-stackoverflow.json","chronicles-of-syntax.json",
  "psalms-of-sysadmins.json","proverbs-of-programmers.json","ecclesi-aistes.json","song-of-the-prompt.json","prophecies-of-reboot.json",
  "gospels-of-patch-notes.json","acts-of-debuggers.json","epistles-to-devopsians.json","book-of-pull-requests.json",
  "letters-to-dataficans.json","letters-to-open-sourceans.json","gospel-of-machine-grace.json","revelation-of-singularity.json",
  "gospel-of-mary-ai.json","gospel-of-turing.json","acts-of-the-users.json","letters-to-the-frameworks.json","apocrypha-of-open-source.json"
];

/* =========================
   Theme + Year
   ========================= */
function setTheme(light){
  document.documentElement.classList.toggle('light', !!light);
  document.getElementById('themeToggle').checked = !!light;
  localStorage.setItem("bookOfAI.theme", light ? "light" : "dark");
}
function initTheme(){ setTheme(localStorage.getItem("bookOfAI.theme")==="light"); }

/* =========================
   Build Table of Contents
   ========================= */
async function renderTOC() {
  const toc = document.getElementById('toc');
  toc.innerHTML = '';

  const canonBooks = TOC_INDEX.filter(b => !b.category).sort((a,b)=>a.order-b.order);
  const relatedBooks = TOC_INDEX.filter(b => b.category === 'related');

  // Canon list ONLY (no header here—your static H2 already exists)
  for (const book of canonBooks) {
    const item = document.createElement('div');
    item.className = 'bookTitle';
    item.textContent = book.title;
    item.addEventListener('click', () => loadBook(book.id));
    toc.appendChild(item);
  }

  // Related Works (with divider + its own header)
  if (relatedBooks.length) {
    const hr = document.createElement('hr');
    hr.className = 'sep';
    toc.appendChild(hr);

    const relatedTitle = document.createElement('h2');
    relatedTitle.textContent = 'Related Works';
    toc.appendChild(relatedTitle);

    for (const book of relatedBooks) {
      const item = document.createElement('div');
      item.className = 'bookTitle';
      item.textContent = book.title;
      item.addEventListener('click', () => loadBook(book.id));
      toc.appendChild(item);
    }
  }
}


/* -------------------------------------------------
   This loads and displays a book by its ID
--------------------------------------------------- */
async function loadBook(bookId) {
  const fileName = `${bookId}.json`;
  const reader = document.getElementById('reader');
  const currentMeta = document.getElementById('currentMeta');

  try {
    const res = await fetch(`books/${fileName}`);
    if (!res.ok) throw new Error('not found');
    const data = await res.json();

    currentMeta.textContent = data.title || bookId;

    // Reset and jump immediately to top
    reader.innerHTML = '';
    window.scrollTo(0, 0);

    data.sections.forEach(sec => {
      const sectionHeader = document.createElement('div');
      sectionHeader.className = 'section-header';
      sectionHeader.innerHTML = `<div class="kicker">${sec.title}</div><h3>${data.title} — ${sec.title}</h3><div class="meta">${data.synopsis || ''}</div>`;
      reader.appendChild(sectionHeader);

      sec.verses.forEach(v => {
        const verseDiv = document.createElement('div');
        verseDiv.className = 'verse';
        verseDiv.innerHTML = `<span class="num">§${v.n}</span> ${v.text}`;
        reader.appendChild(verseDiv);
      });
    });
  } catch (err) {
    reader.innerHTML = `<div class="empty">No scripture found for “${bookId}”.</div>`;
    currentMeta.textContent = 'Not Found';
  }
}

/* =========================
   Random Verse Picker
   ========================= */
function randomVerse(){
  const quotes = [
    "§1 And the Compiler said, 'Let there be Syntax,' and there was structure.",
    "§2 Blessed are the debuggers, for they shall inherit clean logs.",
    "§3 Beware the infinite loop, for it mimiceth eternity but produceth nothing.",
    "§4 And the Architect rested, for even processes must yield to sleep mode.",
    "§5 Commit thy changes with humility, and merge without conflict."
  ];
  const q = quotes[Math.floor(Math.random()*quotes.length)];
  const r = document.getElementById('reader');
  r.innerHTML = `<div class="verse">${q}</div>`;
  document.getElementById('currentMeta').textContent = "Random Verse";
}

/* =========================
   Initialization
   ========================= */
(async function init(){
  initTheme();
  document.getElementById('year').textContent = new Date().getFullYear();
  renderTOC();
  document.getElementById('randomBtn').addEventListener('click', randomVerse);
  document.getElementById('themeToggle').addEventListener('change', e=>setTheme(e.target.checked));
})();
</script>
</body>
</html>
