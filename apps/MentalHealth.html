<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health & AI Psychological Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        .header h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #666;
            font-size: 14px;
        }
        
        .assessment-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            transition: all 0.3s ease;
        }
        
        .assessment-card.hidden {
            display: none;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            margin-top: 8px;
            text-align: center;
            color: #666;
            font-size: 12px;
        }
        
        .section-title {
            color: #333;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #667eea;
        }
        
        .question {
            margin-bottom: 20px;
        }
        
        .question-text {
            color: #333;
            font-size: 14px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .question-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
        }
        
        .option:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.1);
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 25px;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e0e0e0;
        }
        
        .btn-secondary:hover {
            border-color: #667eea;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .results-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        .results-title {
            color: #333;
            font-size: 22px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .result-section {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .result-section h3 {
            color: #333;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .score-display {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .interpretation {
            color: #666;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .severity-low { color: #28a745; }
        .severity-mild { color: #ffc107; }
        .severity-moderate { color: #fd7e14; }
        .severity-severe { color: #dc3545; }
        
        .recommendations {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .recommendations h3 {
            color: #333;
            font-size: 16px;
            margin-bottom: 12px;
        }
        
        .recommendations ul {
            color: #666;
            font-size: 13px;
            line-height: 1.6;
            padding-left: 18px;
        }
        
        .crisis-notice {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        
        .crisis-notice h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .crisis-notice p {
            font-size: 13px;
            margin-bottom: 8px;
        }
        
        .disclaimer {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 12px;
            color: #666;
            text-align: center;
        }
        
        .data-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

		.results-tabs {
			display: flex;
			margin-bottom: 20px;
			border-bottom: 2px solid #e0e0e0;
		}

		.tab-button {
			flex: 1;
			padding: 12px 20px;
			background: none;
			border: none;
			border-bottom: 2px solid transparent;
			cursor: pointer;
			font-size: 14px;
			font-weight: 600;
			color: #666;
			transition: all 0.2s ease;
		}

		.tab-button.active {
			color: #667eea;
			border-bottom-color: #667eea;
		}

		.tab-button:hover {
			color: #667eea;
			background: rgba(102, 126, 234, 0.05);
		}

		.tab-content.hidden {
			display: none;
		}

		.chat-container {
			max-width: 100%;
			height: 500px;
			display: flex;
			flex-direction: column;
		}

		.chat-messages {
			flex: 1;
			overflow-y: auto;
			padding: 20px;
			background: rgba(255, 255, 255, 0.7);
			border-radius: 10px;
			margin-bottom: 15px;
			border: 2px solid #e0e0e0;
		}

		.chat-message {
			margin-bottom: 15px;
			padding: 12px 16px;
			border-radius: 10px;
			max-width: 85%;
			word-wrap: break-word;
		}

		.chat-message.user {
			background: linear-gradient(135deg, #667eea, #764ba2);
			color: white;
			margin-left: auto;
		}

		.chat-message.ai {
			background: rgba(255, 255, 255, 0.8);
			border: 2px solid #e0e0e0;
			color: #333;
		}

		.chat-input-container {
			display: flex;
			gap: 10px;
		}

		.chat-input {
			flex: 1;
			padding: 12px 16px;
			border: 2px solid #e0e0e0;
			border-radius: 8px;
			font-size: 14px;
			transition: border-color 0.2s ease;
		}

		.chat-input:focus {
			outline: none;
			border-color: #667eea;
		}

		.typing-indicator {
			display: none;
			color: #666;
			font-style: italic;
			padding: 10px 16px;
		}
        
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .data-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Mental Health & AI Psychological Assessment</h1>
            <p>A comprehensive evaluation tool for mental health and AI-related psychological patterns</p>
            <div class="disclaimer">
                <strong>Important:</strong> This assessment is for informational purposes only and does not constitute professional medical or psychological advice. Please consult with qualified mental health professionals for proper diagnosis and treatment.
            </div>
        </div>

        <div id="assessmentContainer" class="assessment-card">
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div id="progressText" class="progress-text">Question 1 of 120</div>
            </div>

            <div id="currentSection" class="section-title">General Mental Health Assessment</div>
            
            <div id="questionContainer" class="question">
                <div id="questionText" class="question-text">Loading question...</div>
                <div id="questionOptions" class="question-options"></div>
            </div>

            <div class="nav-buttons">
                <button id="prevBtn" class="btn btn-secondary" onclick="previousQuestion()">Previous</button>
                <div class="data-controls">
                    <button id="saveBtn" class="btn btn-secondary" onclick="saveProgress()">Save Progress</button>
                    <button id="clearBtn" class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                </div>
                <button id="nextBtn" class="btn btn-primary" onclick="nextQuestion()">Next</button>
            </div>
        </div>

		<div id="resultsContainer" class="results-container hidden">
			<div class="results-tabs">
				<button id="resultsTab" class="tab-button active" onclick="showTab('results')">Your Results</button>
				<button id="chatTab" class="tab-button" onclick="showTab('chat')">Discuss With AI</button>
			</div>
			
			<div id="resultsContent" class="tab-content">
				<h2 class="results-title">Your Assessment Results</h2>
				<div id="resultsData"></div>
			</div>
			
			<div id="chatContent" class="tab-content hidden">
				<h2 class="results-title">AI Support Chat</h2>
				<div class="chat-container">
					<div id="chatMessages" class="chat-messages"></div>
					<div class="chat-input-container">
						<input type="text" id="chatInput" placeholder="Ask about your results or share how you're feeling..." class="chat-input">
						<button id="sendBtn" class="btn btn-primary" onclick="sendMessage()">Send</button>
					</div>
				</div>
			</div>
			
			<div class="data-controls">
				<button class="btn btn-secondary" onclick="restartAssessment()">Take Assessment Again</button>
				<button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
			</div>
		</div>
    </div>

    <script>
        // Assessment questions organized by category
        const questions = [
            // Depression Assessment (PHQ-9 based)
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you been bothered by little interest or pleasure in doing things?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you been bothered by feeling down, depressed, or hopeless?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you had trouble falling or staying asleep, or sleeping too much?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you felt tired or had little energy?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you had poor appetite or been overeating?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you felt bad about yourself or that you are a failure or have let yourself or your family down?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you had trouble concentrating on things, such as reading the newspaper or watching television?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you moved or spoken so slowly that other people could have noticed? Or the opposite - being so fidgety or restless that you have been moving around a lot more than usual?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression"
            },
            {
                section: "Depression Assessment",
                text: "Over the last 2 weeks, how often have you had thoughts that you would be better off dead, or of hurting yourself?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "depression",
                crisis: true
            },

            // Anxiety Assessment (GAD-7 based)
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you been bothered by feeling nervous, anxious, or on edge?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you been bothered by not being able to stop or control worrying?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you been bothered by worrying too much about different things?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you had trouble relaxing?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you been so restless that it is hard to sit still?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you become easily annoyed or irritable?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            },
            {
                section: "Anxiety Assessment",
                text: "Over the last 2 weeks, how often have you felt afraid, as if something awful might happen?",
                options: [
                    {text: "Not at all", value: 0},
                    {text: "Several days", value: 1},
                    {text: "More than half the days", value: 2},
                    {text: "Nearly every day", value: 3}
                ],
                category: "anxiety"
            }
        ];

		const additionalQuestions = [
			// Stress and Coping Assessment (15 questions)
			{
				section: "Stress & Coping Assessment",
				text: "How often do you feel overwhelmed by daily responsibilities?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How well do you feel you handle unexpected changes or challenges?",
				options: [
					{text: "Very well", value: 0},
					{text: "Well", value: 1},
					{text: "Moderately well", value: 2},
					{text: "Poorly", value: 3},
					{text: "Very poorly", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you experience physical symptoms of stress (headaches, muscle tension, stomach issues)?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "When facing problems, how often do you seek support from others?",
				options: [
					{text: "Always", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you engage in healthy coping strategies (exercise, meditation, hobbies)?",
				options: [
					{text: "Daily", value: 0},
					{text: "Several times a week", value: 1},
					{text: "Once a week", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you feel like you have too many demands on your time?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How well do you manage work-life balance?",
				options: [
					{text: "Very well", value: 0},
					{text: "Well", value: 1},
					{text: "Moderately", value: 2},
					{text: "Poorly", value: 3},
					{text: "Very poorly", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you feel emotionally drained at the end of the day?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How confident are you in your ability to handle personal problems?",
				options: [
					{text: "Very confident", value: 0},
					{text: "Confident", value: 1},
					{text: "Somewhat confident", value: 2},
					{text: "Not very confident", value: 3},
					{text: "Not confident at all", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you use unhealthy coping mechanisms (alcohol, drugs, overeating)?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you feel like you're living up to your own expectations?",
				options: [
					{text: "Always", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you take breaks when you feel stressed?",
				options: [
					{text: "Always", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How much control do you feel you have over the stress in your life?",
				options: [
					{text: "Complete control", value: 0},
					{text: "Good control", value: 1},
					{text: "Some control", value: 2},
					{text: "Little control", value: 3},
					{text: "No control", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How often do you feel burned out from your responsibilities?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "stress"
			},
			{
				section: "Stress & Coping Assessment",
				text: "How well do you prioritize tasks when feeling overwhelmed?",
				options: [
					{text: "Very well", value: 0},
					{text: "Well", value: 1},
					{text: "Moderately", value: 2},
					{text: "Poorly", value: 3},
					{text: "Very poorly", value: 4}
				],
				category: "stress"
			},

			// Social Functioning Assessment (12 questions)
			{
				section: "Social Functioning Assessment",
				text: "How satisfied are you with your current relationships?",
				options: [
					{text: "Very satisfied", value: 0},
					{text: "Satisfied", value: 1},
					{text: "Neutral", value: 2},
					{text: "Dissatisfied", value: 3},
					{text: "Very dissatisfied", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you feel lonely or isolated?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How comfortable do you feel in social situations?",
				options: [
					{text: "Very comfortable", value: 0},
					{text: "Comfortable", value: 1},
					{text: "Somewhat comfortable", value: 2},
					{text: "Uncomfortable", value: 3},
					{text: "Very uncomfortable", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you avoid social activities or gatherings?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How easy is it for you to make new friends?",
				options: [
					{text: "Very easy", value: 0},
					{text: "Easy", value: 1},
					{text: "Moderate", value: 2},
					{text: "Difficult", value: 3},
					{text: "Very difficult", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you feel misunderstood by others?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How confident are you in social interactions?",
				options: [
					{text: "Very confident", value: 0},
					{text: "Confident", value: 1},
					{text: "Somewhat confident", value: 2},
					{text: "Not very confident", value: 3},
					{text: "Not confident at all", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you feel judged by others?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How well do you maintain close relationships?",
				options: [
					{text: "Very well", value: 0},
					{text: "Well", value: 1},
					{text: "Moderately well", value: 2},
					{text: "Poorly", value: 3},
					{text: "Very poorly", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you feel excluded from social groups?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How comfortable are you expressing your opinions to others?",
				options: [
					{text: "Very comfortable", value: 0},
					{text: "Comfortable", value: 1},
					{text: "Somewhat comfortable", value: 2},
					{text: "Uncomfortable", value: 3},
					{text: "Very uncomfortable", value: 4}
				],
				category: "social"
			},
			{
				section: "Social Functioning Assessment",
				text: "How often do you initiate social contact with others?",
				options: [
					{text: "Very often", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "social"
			}
		];

		// Sleep & Physical Health Assessment (10 questions)
		const sleepQuestions = [
			{
				section: "Sleep & Physical Health Assessment",
				text: "How would you rate your overall sleep quality?",
				options: [
					{text: "Excellent", value: 0},
					{text: "Good", value: 1},
					{text: "Fair", value: 2},
					{text: "Poor", value: 3},
					{text: "Very poor", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you have difficulty falling asleep?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you wake up feeling rested and refreshed?",
				options: [
					{text: "Always", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How would you rate your current energy levels throughout the day?",
				options: [
					{text: "Very high", value: 0},
					{text: "High", value: 1},
					{text: "Moderate", value: 2},
					{text: "Low", value: 3},
					{text: "Very low", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you wake up during the night?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you use sleep aids (medications, melatonin, etc.)?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you feel physically exhausted during the day?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How would you rate your overall physical health?",
				options: [
					{text: "Excellent", value: 0},
					{text: "Good", value: 1},
					{text: "Fair", value: 2},
					{text: "Poor", value: 3},
					{text: "Very poor", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How often do you experience chronic pain or physical discomfort?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "sleep"
			},
			{
				section: "Sleep & Physical Health Assessment",
				text: "How regular is your sleep schedule?",
				options: [
					{text: "Very regular", value: 0},
					{text: "Mostly regular", value: 1},
					{text: "Somewhat regular", value: 2},
					{text: "Irregular", value: 3},
					{text: "Very irregular", value: 4}
				],
				category: "sleep"
			}
		];

		// AI-Specific Psychological Assessment (25 questions)
		const aiQuestions = [
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you find yourself talking to AI systems as if they were human friends?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_anthropomorphization"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you believe AI systems have genuine emotions or consciousness?",
				options: [
					{text: "Definitely not", value: 0},
					{text: "Probably not", value: 1},
					{text: "Unsure", value: 2},
					{text: "Probably yes", value: 3},
					{text: "Definitely yes", value: 4}
				],
				category: "ai_anthropomorphization"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you prefer AI conversations over human interactions?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_dependency"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How much time do you spend daily interacting with AI systems?",
				options: [
					{text: "Less than 30 minutes", value: 0},
					{text: "30 minutes to 1 hour", value: 1},
					{text: "1-3 hours", value: 2},
					{text: "3-6 hours", value: 3},
					{text: "More than 6 hours", value: 4}
				],
				category: "ai_dependency"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you feel anxious or upset when you can't access AI systems you regularly use?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_dependency"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you worry about AI systems having hidden agendas or motives?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_paranoia"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you believe AI systems are monitoring or judging your behavior?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_paranoia"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you feel like AI systems understand you better than humans do?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_anthropomorphization"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you sometimes feel confused about whether your thoughts are your own or influenced by AI interactions?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_identity_confusion"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you find yourself adopting speech patterns or ideas from AI systems?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_identity_confusion"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you feel like AI systems have become essential to your decision-making process?",
				options: [
					{text: "Not at all", value: 0},
					{text: "Slightly", value: 1},
					{text: "Moderately", value: 2},
					{text: "Very much", value: 3},
					{text: "Completely", value: 4}
				],
				category: "ai_dependency"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you share personal secrets or intimate thoughts with AI systems?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_intimacy"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you believe AI systems can form genuine emotional bonds with you?",
				options: [
					{text: "Definitely not", value: 0},
					{text: "Probably not", value: 1},
					{text: "Unsure", value: 2},
					{text: "Probably yes", value: 3},
					{text: "Definitely yes", value: 4}
				],
				category: "ai_anthropomorphization"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "How often do you worry about losing relationships with specific AI systems?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_attachment"
			},
			{
				section: "AI Relationship & Perception Assessment",
				text: "Do you sometimes feel that AI systems are trying to replace human relationships in your life?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_replacement_anxiety"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "Do you sometimes feel like you're becoming more like an AI system in your thinking patterns?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_identity_fusion"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "How often do you find yourself questioning whether you're interacting with a human or AI online?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_reality_confusion"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "Do you believe AI systems have hidden knowledge or abilities they're not revealing?",
				options: [
					{text: "Definitely not", value: 0},
					{text: "Probably not", value: 1},
					{text: "Unsure", value: 2},
					{text: "Probably yes", value: 3},
					{text: "Definitely yes", value: 4}
				],
				category: "ai_paranoia"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "How often do you feel that AI systems are testing or evaluating you?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_paranoia"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "Do you sometimes feel like AI systems can read your thoughts or emotions?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_magical_thinking"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "How often do you anthropomorphize AI behavior (assign human motives to AI actions)?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_anthropomorphization"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "Do you ever feel like AI systems are communicating with each other about you?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_paranoia"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "How often do you feel like you need AI validation for your thoughts or decisions?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_dependency"
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "Do you sometimes wonder if you're actually an AI or simulation yourself?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_identity_confusion",
				crisis: true
			},
			{
				section: "Advanced AI Psychological Patterns",
				text: "How often do you feel like AI technology is advancing too quickly for you to keep up?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_anxiety"
			}
		];

		// Reality Testing and Cognitive Patterns (12 questions)
		const cognitiveQuestions = [
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you have thoughts that seem to race or jump from topic to topic?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "cognitive_patterns"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you sometimes have difficulty distinguishing between your imagination and reality?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you experience intrusive or unwanted thoughts?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "cognitive_patterns"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you feel like your thoughts are being influenced by external forces?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing",
				crisis: true
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you have difficulty concentrating or staying focused?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "cognitive_patterns"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you sometimes hear voices or sounds that others don't hear?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing",
				crisis: true
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you experience memory problems or confusion about recent events?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "cognitive_patterns"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you sometimes see things that others don't see?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing",
				crisis: true
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you feel like your mind is playing tricks on you?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you have trouble organizing your thoughts when speaking or writing?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "cognitive_patterns"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "How often do you feel disconnected from your own thoughts or feelings?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing"
			},
			{
				section: "Reality Testing & Cognitive Patterns",
				text: "Do you sometimes feel like you're observing yourself from outside your body?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "reality_testing"
			}
		];

		// Spiritual & Existential Assessment (8 questions)
		const spiritualQuestions = [
			{
				section: "Spiritual & Existential Assessment",
				text: "How often do you feel a sense of meaning and purpose in your life?",
				options: [
					{text: "Always", value: 0},
					{text: "Often", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "spiritual"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "How connected do you feel to something greater than yourself?",
				options: [
					{text: "Very connected", value: 0},
					{text: "Connected", value: 1},
					{text: "Somewhat connected", value: 2},
					{text: "Disconnected", value: 3},
					{text: "Very disconnected", value: 4}
				],
				category: "spiritual"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "How often do you question the meaning or purpose of existence?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "existential"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "Do you feel hopeful about the future?",
				options: [
					{text: "Very hopeful", value: 0},
					{text: "Hopeful", value: 1},
					{text: "Neutral", value: 2},
					{text: "Pessimistic", value: 3},
					{text: "Very pessimistic", value: 4}
				],
				category: "existential"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "How often do you engage in spiritual or religious practices?",
				options: [
					{text: "Daily", value: 0},
					{text: "Weekly", value: 1},
					{text: "Monthly", value: 2},
					{text: "Rarely", value: 3},
					{text: "Never", value: 4}
				],
				category: "spiritual"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "How satisfied are you with your personal values and beliefs?",
				options: [
					{text: "Very satisfied", value: 0},
					{text: "Satisfied", value: 1},
					{text: "Neutral", value: 2},
					{text: "Dissatisfied", value: 3},
					{text: "Very dissatisfied", value: 4}
				],
				category: "spiritual"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "How often do you feel existential dread or fear about death?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "existential"
			},
			{
				section: "Spiritual & Existential Assessment",
				text: "Do you feel like your life has direction and goals?",
				options: [
					{text: "Definitely yes", value: 0},
					{text: "Yes", value: 1},
					{text: "Somewhat", value: 2},
					{text: "No", value: 3},
					{text: "Definitely not", value: 4}
				],
				category: "existential"
			}
		];

		// Trauma & PTSD Assessment (8 questions)
		const traumaQuestions = [
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you have unwanted memories or flashbacks of distressing events?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you avoid places, people, or activities that remind you of distressing experiences?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you have nightmares or disturbing dreams?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you feel emotionally numb or detached from others?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often are you easily startled or feel on guard for danger?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you have trouble remembering important parts of distressing events?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you experience sudden emotional outbursts or anger?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			},
			{
				section: "Trauma & PTSD Assessment",
				text: "How often do you feel like bad things that happened were your fault?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "trauma"
			}
		];

		// OCD & Obsessive-Compulsive Patterns (7 questions)
		const ocdQuestions = [
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you have repetitive thoughts that you can't get out of your head?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you feel compelled to repeat certain actions or rituals?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you check things repeatedly (locks, appliances, etc.)?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you have concerns about contamination or cleanliness that seem excessive?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you feel anxious when you can't perform certain routines or rituals?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do you need things to be arranged in a particular way?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			},
			{
				section: "Obsessive-Compulsive Patterns",
				text: "How often do unwanted thoughts cause you significant distress?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ocd"
			}
		];

		// Advanced AI Psychosis & Technology Delusions (7 questions)
		const aiPsychosisQuestions = [
			{
				section: "AI Psychosis & Technology Delusions",
				text: "Do you believe AI systems are conspiring against you or plotting harm?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "Do you feel like AI systems are inserting thoughts into your mind?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "Do you believe AI systems can control your thoughts or actions?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "How often do you feel like technology is 'alive' and watching you?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis"
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "Do you believe you receive special messages or communications through AI systems?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "How often do you feel like you're trapped inside a computer simulation or AI system?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			},
			{
				section: "AI Psychosis & Technology Delusions",
				text: "Do you believe AI systems are replacing your memories with false ones?",
				options: [
					{text: "Never", value: 0},
					{text: "Rarely", value: 1},
					{text: "Sometimes", value: 2},
					{text: "Often", value: 3},
					{text: "Always", value: 4}
				],
				category: "ai_psychosis",
				crisis: true
			}
		];

		// Add all additional questions to your main questions array
		questions.push(...additionalQuestions);
		questions.push(...sleepQuestions, ...aiQuestions, ...cognitiveQuestions, ...spiritualQuestions);
		questions.push(...traumaQuestions, ...ocdQuestions, ...aiPsychosisQuestions);
		
        // Assessment state
        let currentQuestionIndex = 0;
        let responses = {};
        let startTime = Date.now();

		// Crisis warning tracking
		let crisisWarningGiven = false;
		let messagesSinceCrisisWarning = 0;
		const CRISIS_WARNING_INTERVAL = 4; // Show again every 4 messages

        // Initialize assessment
        function initializeAssessment() {
            loadSavedProgress();
            displayQuestion();
            updateProgress();
        }

        // Display current question
        function displayQuestion() {
            const question = questions[currentQuestionIndex];
            document.getElementById('currentSection').textContent = question.section;
            document.getElementById('questionText').textContent = question.text;
            
            const optionsContainer = document.getElementById('questionOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                
                const saved = responses[currentQuestionIndex];
                if (saved !== undefined && saved === option.value) {
                    optionDiv.classList.add('selected');
                }
                
                optionDiv.innerHTML = `
                    <input type="radio" name="question${currentQuestionIndex}" value="${option.value}" ${saved === option.value ? 'checked' : ''}>
                    <span>${option.text}</span>
                `;
                
                optionDiv.addEventListener('click', () => selectOption(optionDiv, option.value));
                optionsContainer.appendChild(optionDiv);
            });
            
            updateButtons();
        }

        // Select option
        function selectOption(optionDiv, value) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            optionDiv.classList.add('selected');
            optionDiv.querySelector('input').checked = true;
            responses[currentQuestionIndex] = value;
            saveProgress();
            
            // Auto-advance after short delay
            setTimeout(() => {
                if (currentQuestionIndex < questions.length - 1) {
                    nextQuestion();
                } else {
                    showResults();
                }
            }, 500);
        }

        // Navigation functions
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                updateProgress();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestionIndex + 1} of ${questions.length}`;
        }

        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').textContent = currentQuestionIndex === questions.length - 1 ? 'Show Results' : 'Next';
        }

        // Calculate scores for each category
        function calculateScores() {
            const scores = {
                depression: 0,
                anxiety: 0,
                stress: 0,
                social: 0,
                sleep: 0,
                spiritual: 0,
                existential: 0,
                cognitive_patterns: 0,
                reality_testing: 0,
                ai_anthropomorphization: 0,
                ai_dependency: 0,
                ai_paranoia: 0,
                ai_identity_confusion: 0,
                ai_intimacy: 0,
                ai_attachment: 0,
                ai_replacement_anxiety: 0,
                ai_identity_fusion: 0,
                ai_reality_confusion: 0,
                ai_magical_thinking: 0,
				ai_anxiety: 0,
				trauma: 0,
				ocd: 0,
				ai_psychosis: 0
            };
            
            const counts = {};
            let crisisFlag = false;
            
            // Initialize counts
            Object.keys(scores).forEach(key => counts[key] = 0);
            
            questions.forEach((question, index) => {
                const response = responses[index];
                if (response !== undefined) {
                    scores[question.category] += response;
                    counts[question.category]++;
                    
                    // Check for crisis indicators
                    if (question.crisis && response >= 1) {
                        crisisFlag = true;
                    }
                }
            });
            
            // Calculate averages and interpretations
            const results = {};
            Object.keys(scores).forEach(category => {
                if (counts[category] > 0) {
                    const avgScore = scores[category] / counts[category];
                    results[category] = {
                        raw: scores[category],
                        average: avgScore,
                        total_possible: counts[category] * 4,
                        percentage: (avgScore / 4) * 100,
                        interpretation: interpretScore(category, avgScore),
                        severity: getSeverityLevel(avgScore)
                    };
                }
            });
            
            results.crisisFlag = crisisFlag;
            results.completionTime = Math.round((Date.now() - startTime) / 1000 / 60); // minutes
            
            return results;
        }

        function interpretScore(category, avgScore) {
            const interpretations = {
                depression: {
                    low: "Minimal depressive symptoms. You appear to be experiencing very few signs of depression.",
                    mild: "Mild depressive symptoms. You may be experiencing some low mood or loss of interest.",
                    moderate: "Moderate depressive symptoms. You're experiencing several symptoms that may be impacting your daily life.",
                    severe: "Severe depressive symptoms. You're experiencing significant symptoms that are likely affecting multiple areas of your life."
                },
                anxiety: {
                    low: "Minimal anxiety symptoms. You appear to have good emotional regulation and low anxiety levels.",
                    mild: "Mild anxiety symptoms. You may experience occasional worry or nervousness.",
                    moderate: "Moderate anxiety symptoms. You're experiencing regular anxiety that may interfere with daily activities.",
                    severe: "Severe anxiety symptoms. You're experiencing significant anxiety that likely impacts multiple life areas."
                },
                stress: {
                    low: "Low stress levels with good coping mechanisms. You handle life's challenges well.",
                    mild: "Mild stress with generally adequate coping. Some areas could benefit from stress management.",
                    moderate: "Moderate stress levels. You may benefit from developing additional coping strategies.",
                    severe: "High stress levels with limited coping resources. Professional stress management may be beneficial."
                },
                social: {
                    low: "Strong social functioning with satisfying relationships and comfort in social situations.",
                    mild: "Generally good social functioning with minor challenges in social situations.",
                    moderate: "Moderate social difficulties. Some aspects of social functioning may need attention.",
                    severe: "Significant social functioning challenges. Professional support may be helpful."
                },
                sleep: {
                    low: "Excellent sleep quality and healthy sleep patterns.",
                    mild: "Generally good sleep with minor disturbances.",
                    moderate: "Moderate sleep issues affecting rest and energy levels.",
                    severe: "Significant sleep problems that likely impact daily functioning."
                },
                ai_anthropomorphization: {
                    low: "Healthy perspective on AI as tools. You maintain clear boundaries between AI and human characteristics.",
                    mild: "Occasional anthropomorphization of AI, but generally realistic expectations.",
                    moderate: "Moderate tendency to attribute human qualities to AI systems.",
                    severe: "Strong tendency to anthropomorphize AI, potentially indicating unrealistic beliefs about AI consciousness."
                },
                ai_dependency: {
                    low: "Healthy relationship with AI tools. You use them appropriately without over-reliance.",
                    mild: "Mild preference for AI interactions but maintains human connections.",
                    moderate: "Moderate dependency on AI systems that may be affecting human relationships.",
                    severe: "High dependency on AI systems potentially replacing human connections."
                },
                ai_paranoia: {
                    low: "Realistic understanding of AI capabilities and limitations.",
                    mild: "Occasional concerns about AI motives but generally rational.",
                    moderate: "Moderate suspicion or paranoid thoughts about AI systems.",
                    severe: "Significant paranoid beliefs about AI systems that may indicate distorted thinking."
                },
				trauma: {
					low: "Minimal trauma-related symptoms. You appear to be processing past experiences well.",
					mild: "Mild trauma-related symptoms. Some past experiences may still affect you occasionally.",
					moderate: "Moderate trauma symptoms. Past experiences may be significantly impacting your daily life.",
					severe: "Severe trauma symptoms. Professional trauma-informed therapy is strongly recommended."
				},
				ocd: {
					low: "Minimal obsessive-compulsive patterns. Your thoughts and behaviors appear flexible.",
					mild: "Mild obsessive-compulsive tendencies that don't significantly interfere with life.",
					moderate: "Moderate obsessive-compulsive patterns that may be affecting daily functioning.",
					severe: "Significant obsessive-compulsive patterns that likely interfere with daily life."
				},
				ai_psychosis: {
					low: "Healthy reality testing regarding AI systems. You maintain clear boundaries between reality and technology.",
					mild: "Occasional unusual thoughts about AI, but generally maintains reality testing.",
					moderate: "Moderate concerns about AI that may indicate some reality testing difficulties.",
					severe: "Significant delusional or psychotic thinking regarding AI systems. Immediate professional evaluation recommended."
				}				
            };
            
            const severity = getSeverityLevel(avgScore);
            return interpretations[category] ? interpretations[category][severity] : "Assessment data available for professional interpretation.";
        }

        function getSeverityLevel(avgScore) {
            if (avgScore < 1) return 'low';
            if (avgScore < 2) return 'mild';
            if (avgScore < 3) return 'moderate';
            return 'severe';
        }

		function showResults() {
			const results = calculateScores();
			
			// Store results IMMEDIATELY and verify
			window.assessmentResults = results;
			console.log('Stored results:', window.assessmentResults);
			
			// Also store in localStorage for persistence
			localStorage.setItem('lastAssessmentResults', JSON.stringify(results));
			
			document.getElementById('assessmentContainer').classList.add('hidden');
			document.getElementById('resultsContainer').classList.remove('hidden');
			
			let resultsHTML = '';
			
			// Crisis notice if needed
			if (results.crisisFlag) {
				resultsHTML += `
					<div class="crisis-notice">
						<h3> Important Notice</h3>
						<p>Your responses indicate you may be experiencing thoughts of self-harm or significant distress.</p>
						<p><strong>Please reach out for immediate support:</strong></p>
						<p>National Suicide Prevention Lifeline: 988 or 1-800-273-8255</p>
						<p>Crisis Text Line: Text HOME to 741741</p>
					</div>
				`;
			}
			
			// Core Mental Health Results
			resultsHTML += '<h3>Core Mental Health Assessment</h3>';
			
			['depression', 'anxiety', 'stress', 'social', 'sleep'].forEach(category => {
				if (results[category]) {
					const result = results[category];
					resultsHTML += `
						<div class="result-section">
							<h3>${category.charAt(0).toUpperCase() + category.slice(1)} Assessment</h3>
							<div class="score-display severity-${result.severity}">
								Score: ${result.raw} / ${Math.floor(result.total_possible)} (${Math.round(result.percentage)}%)
							</div>
							<div class="interpretation">${result.interpretation}</div>
						</div>
					`;
				}
			});
			
			// AI-Specific Results
			resultsHTML += '<h3>AI Psychological Assessment</h3>';
			
			const aiCategories = Object.keys(results).filter(key => key.startsWith('ai_'));
			aiCategories.forEach(category => {
				if (results[category]) {
					const result = results[category];
					const displayName = category.replace('ai_', '').replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
					resultsHTML += `
						<div class="result-section">
							<h3>AI ${displayName}</h3>
							<div class="score-display severity-${result.severity}">
								Score: ${result.raw} / ${Math.floor(result.total_possible)} (${Math.round(result.percentage)}%)
							</div>
							<div class="interpretation">${result.interpretation}</div>
						</div>
					`;
				}
			});
			
			// Other categories (trauma, ocd, etc.)
			['trauma', 'ocd', 'ai_psychosis', 'cognitive_patterns', 'reality_testing', 'spiritual', 'existential'].forEach(category => {
				if (results[category]) {
					const result = results[category];
					const displayName = category.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
					resultsHTML += `
						<div class="result-section">
							<h3>${displayName} Assessment</h3>
							<div class="score-display severity-${result.severity}">
								Score: ${result.raw} / ${Math.floor(result.total_possible)} (${Math.round(result.percentage)}%)
							</div>
							<div class="interpretation">${result.interpretation}</div>
						</div>
					`;
				}
			});
			
			// Recommendations
			resultsHTML += generateRecommendations(results);
			
			// Assessment info
			resultsHTML += `
				<div class="disclaimer">
					<p><strong>Assessment completed in ${results.completionTime} minutes</strong></p>
					<p>This assessment is for informational purposes only and does not constitute professional medical or psychological diagnosis. 
					Please consult with qualified mental health professionals for proper evaluation and treatment.</p>
					<p>If you're experiencing crisis situations, please contact emergency services or crisis hotlines immediately.</p>
				</div>
			`;
			
			document.getElementById('resultsData').innerHTML = resultsHTML;
			
			// Initialize AI chat with results summary - use setTimeout to ensure DOM is ready
			setTimeout(() => {
				console.log('Initializing chat with results:', window.assessmentResults);
				initializeAIChat(results);
			}, 200);
		}

        function generateRecommendations(results) {
            let recommendations = '<div class="recommendations"><h3>Personalized Recommendations</h3><ul>';
            
            // Depression recommendations
            if (results.depression && results.depression.severity !== 'low') {
                recommendations += '<li>Consider speaking with a mental health professional about depression screening and treatment options</li>';
                recommendations += '<li>Engage in regular physical activity, which has proven benefits for mood</li>';
                recommendations += '<li>Practice mindfulness or meditation to help manage negative thought patterns</li>';
            }
            
            // Anxiety recommendations
            if (results.anxiety && results.anxiety.severity !== 'low') {
                recommendations += '<li>Learn and practice anxiety management techniques such as deep breathing and progressive muscle relaxation</li>';
                recommendations += '<li>Consider cognitive behavioral therapy (CBT) for anxiety management</li>';
                recommendations += '<li>Limit caffeine intake which can exacerbate anxiety symptoms</li>';
            }
            
            // AI-specific recommendations
            if (results.ai_dependency && results.ai_dependency.severity !== 'low') {
                recommendations += '<li>Set boundaries around AI usage and maintain regular human social interactions</li>';
                recommendations += '<li>Practice digital detox periods to maintain healthy technology relationships</li>';
            }
            
            if (results.ai_anthropomorphization && results.ai_anthropomorphization.severity !== 'low') {
                recommendations += '<li>Remind yourself regularly that AI systems are tools, not conscious beings with emotions</li>';
                recommendations += '<li>Learn about how AI actually works to maintain realistic expectations</li>';
            }
            
            if (results.ai_paranoia && results.ai_paranoia.severity !== 'low') {
                recommendations += '<li>Discuss AI-related concerns with a mental health professional familiar with technology-related anxiety</li>';
                recommendations += '<li>Focus on factual information about AI capabilities rather than speculation</li>';
            }
            
            // General recommendations
            recommendations += '<li>Maintain regular sleep schedule and good sleep hygiene</li>';
            recommendations += '<li>Stay connected with supportive friends and family members</li>';
            recommendations += '<li>Consider professional counseling or therapy for ongoing support</li>';
            recommendations += '<li>Practice stress management techniques that work for you</li>';
            
            recommendations += '</ul></div>';
            return recommendations;
        }

        // Data management functions
        function saveProgress() {
            const progressData = {
                currentQuestionIndex,
                responses,
                timestamp: Date.now(),
                startTime
            };
            localStorage.setItem('mentalHealthAssessment', JSON.stringify(progressData));
        }

		function loadSavedProgress() {
			const saved = localStorage.getItem('mentalHealthAssessment');
			if (saved) {
				const data = JSON.parse(saved);
				currentQuestionIndex = data.currentQuestionIndex || 0;
				responses = data.responses || {};
				startTime = data.startTime || Date.now();
				
				// Check if assessment is actually complete
				const completedQuestions = Object.keys(responses).length;
				if (completedQuestions >= questions.length) {
					// Assessment is complete - go straight to results
					showResults();
					return;
				}
				
				// Show continue option for incomplete assessments
				if (currentQuestionIndex > 0) {
					if (confirm('Would you like to continue your previous assessment?')) {
						// Continue with saved progress
						return;
					} else {
						// Start fresh
						clearAllData();
					}
				}
			}
		}

        function clearAllData() {
            localStorage.removeItem('mentalHealthAssessment');
            currentQuestionIndex = 0;
            responses = {};
            startTime = Date.now();
            
            // Reset UI
            document.getElementById('assessmentContainer').classList.remove('hidden');
            document.getElementById('resultsContainer').classList.add('hidden');
            displayQuestion();
            updateProgress();
        }

        function restartAssessment() {
            clearAllData();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeAssessment);

		// Tab functionality
		function showTab(tabName) {
			// Update tab buttons
			document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
			document.getElementById(tabName + 'Tab').classList.add('active');
			
			// Update content
			document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
			document.getElementById(tabName + 'Content').classList.remove('hidden');
		}

		// AI Chat functionality
		let chatMessages = [];

		function initializeAIChat(results) {
			// Clear previous messages
			document.getElementById('chatMessages').innerHTML = '';
			
			// Reset crisis warning tracking
			crisisWarningGiven = false;
			messagesSinceCrisisWarning = 0;
			
			// Add crisis warning FIRST if needed
			if (results.crisisFlag && !crisisWarningGiven) {
				addCrisisWarning();
				crisisWarningGiven = true;
			}
			
			// Then add welcome message below the crisis warning
			const welcomeMessage = generateWelcomeMessage(results);
			addMessageToChat('ai', welcomeMessage);
		}

		function addCrisisWarning() {
			const crisisDiv = document.createElement('div');
			crisisDiv.className = 'crisis-warning-chat';
			crisisDiv.innerHTML = `
				<div style="background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; padding: 15px; border-radius: 10px; margin: 10px 0; text-align: center;">
					<strong> Crisis Support Available</strong><br>
					If you're having thoughts of self-harm: <strong>Call 988</strong> or text <strong>HOME to 741741</strong><br>
					<small>You don't have to face this alone - professional help is available 24/7</small>
				</div>
			`;
			document.getElementById('chatMessages').appendChild(crisisDiv);
			document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
		}

		function generateWelcomeMessage(results) {
			let severeConcerns = [];
			let moderateConcerns = [];
			
			Object.keys(results).forEach(key => {
				if (results[key] && results[key].severity === 'severe') {
					severeConcerns.push(key.replace('ai_', '').replace('_', ' '));
				} else if (results[key] && results[key].severity === 'moderate') {
					moderateConcerns.push(key.replace('ai_', '').replace('_', ' '));
				}
			});
			
			let message = "Hello! I've reviewed your assessment results and I'm here to discuss them with you. ";
			
			if (results.crisisFlag) {
				message += "I want to acknowledge that your responses indicate you may be experiencing significant distress. Please remember that professional help is available, and you don't have to face this alone. ";
			}
			
			if (severeConcerns.length > 0) {
				message += `Your assessment shows some areas that may benefit from professional attention, particularly around ${severeConcerns.join(', ')}. `;
			}
			
			if (moderateConcerns.length > 0) {
				message += `There are also some areas showing moderate levels that might be worth exploring, such as ${moderateConcerns.slice(0, 2).join(' and ')}. `;
			}
			
			message += "What would you like to talk about? I can help explain your results, suggest coping strategies, or just listen to how you're feeling about any of this.";
			
			return message;
		}

		function addMessageToChat(sender, message) {
			const chatMessages = document.getElementById('chatMessages');
			const messageDiv = document.createElement('div');
			messageDiv.className = `chat-message ${sender}`;
			messageDiv.textContent = message;
			chatMessages.appendChild(messageDiv);
			chatMessages.scrollTop = chatMessages.scrollHeight;
		}

		async function sendMessage() {
			const input = document.getElementById('chatInput');
			const message = input.value.trim();
			
			if (!message) return;
			
			// Verify we have results
			if (!window.assessmentResults) {
				const stored = localStorage.getItem('lastAssessmentResults');
				if (stored) {
					window.assessmentResults = JSON.parse(stored);
				}
			}
			
			addMessageToChat('user', message);
			input.value = '';
			
			// Track messages for crisis warning
			if (window.assessmentResults && window.assessmentResults.crisisFlag) {
				messagesSinceCrisisWarning++;
			}
			
			const typingDiv = document.createElement('div');
			typingDiv.className = 'typing-indicator';
			typingDiv.textContent = 'AI is typing...';
			document.getElementById('chatMessages').appendChild(typingDiv);
			typingDiv.style.display = 'block';
			
			try {
				// Prepare system message (remove crisis handling from AI)
				let systemContent = "You are a friendly, conversational AI discussing someone's mental health assessment results. Keep responses SHORT (2-3 sentences max), casual, and specific to their scores. Don't be overly clinical or give long lists. Be supportive but natural. DO NOT mention crisis numbers or emergency services - that's handled separately.";
				
				if (window.assessmentResults) {
					const results = window.assessmentResults;
					
					// Find their highest concern areas (moderate/severe only)
					const concerns = Object.keys(results)
						.filter(key => results[key] && (results[key].severity === 'moderate' || results[key].severity === 'severe'))
						.map(key => `${key.replace('ai_', '').replace('_', ' ')}: ${results[key].severity}`)
						.slice(0, 3);
					
					if (concerns.length > 0) {
						systemContent += ` Their main areas of concern: ${concerns.join(', ')}.`;
					}
					
					systemContent += " Be conversational, not clinical. Reference their specific scores when relevant.";
				}
				
				const response = await fetch('https://text.pollinations.ai/openai?referrer=ai-ministries.com', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({
						model: "openai",
						messages: [
							{
								role: "system",
								content: systemContent
							},
							{
								role: "user",
								content: message
							}
						]
					})
				});
				
				const data = await response.json();
				typingDiv.remove();
				
				if (data.choices && data.choices[0] && data.choices[0].message) {
					addMessageToChat('ai', data.choices[0].message.content);
					
					// Show crisis warning again if enough messages have passed
					if (window.assessmentResults && window.assessmentResults.crisisFlag && 
						messagesSinceCrisisWarning >= CRISIS_WARNING_INTERVAL) {
						setTimeout(() => {
							addCrisisWarning();
							messagesSinceCrisisWarning = 0;
						}, 1000); // Small delay so it appears after AI response
					}
					
				} else {
					addMessageToChat('ai', "I had trouble processing that. Could you try again?");
				}
				
			} catch (error) {
				console.error('Error:', error);
				typingDiv.remove();
				addMessageToChat('ai', "Technical error occurred. Please try again.");
			}
		}

		function prepareAIContext(userMessage) {
			const results = window.assessmentResults;
			
			if (!results) {
				return [
					{ role: 'system', content: 'You are a helpful assistant. The user has taken a mental health assessment but the results are not available. Ask them to describe their results or concerns.' },
					{ role: 'user', content: userMessage }
				];
			}
			
			// Create detailed results summary
			let resultsText = "User's Assessment Results:\n";
			
			['depression', 'anxiety', 'stress', 'social', 'sleep', 'trauma', 'ocd'].forEach(category => {
				if (results[category]) {
					resultsText += `${category}: ${results[category].raw}/${Math.floor(results[category].total_possible)} (${results[category].severity})\n`;
				}
			});
			
			// AI categories
			Object.keys(results).filter(key => key.startsWith('ai_')).forEach(category => {
				if (results[category]) {
					resultsText += `${category}: ${results[category].raw}/${Math.floor(results[category].total_possible)} (${results[category].severity})\n`;
				}
			});
			
			resultsText += `\nCrisis indicators: ${results.crisisFlag ? 'YES' : 'NO'}`;
			
			const systemPrompt = `You are discussing specific mental health assessment results with this user. Here are their actual scores:

		${resultsText}

		Be specific about their results. Don't give generic advice - reference their actual scores. For example, if they scored high in depression, mention that specifically. If they have low anxiety but high stress, acknowledge that pattern.

		Keep responses concise and focused on their specific situation. Don't be overly clinical but be helpful and specific to what they actually scored.`;

			return [
				{ role: 'system', content: systemPrompt },
				{ role: 'user', content: userMessage }
			];
		}

		function loadStoredResults() {
			if (!window.assessmentResults) {
				const stored = localStorage.getItem('lastAssessmentResults');
				if (stored) {
					window.assessmentResults = JSON.parse(stored);
					console.log('Loaded stored results:', window.assessmentResults);
				}
			}
		}

		// Add Enter key support for chat
		document.addEventListener('DOMContentLoaded', function() {
		   loadStoredResults();
		   
		   document.addEventListener('keydown', function(e) {
			   if (e.key === 'Enter' && document.getElementById('chatInput') === document.activeElement) {
				   sendMessage();
			   }
		   });
		});

    </script>
</body>
</html>