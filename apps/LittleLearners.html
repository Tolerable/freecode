<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Little Learners Academy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #5a67d8;
        }

        .mode-toggle {
            background: #5a67d8;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .mode-toggle:hover {
            background: #4c51bf;
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Welcome Page Styles */
        .welcome-page {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 3rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .welcome-title {
            font-size: 3rem;
            color: #5a67d8;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .welcome-subtitle {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 2rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .feature-card {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            border-radius: 15px;
            padding: 2rem;
            color: white;
            text-align: center;
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .start-button {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            border: none;
            padding: 1.5rem 3rem;
            font-size: 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 2rem;
            transform: scale(1);
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .start-button:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 20px rgba(0,0,0,0.3);
        }

        /* Kid Mode Styles */
        body.kid-mode .grade-selector {
            text-align: center;
            margin-bottom: 2rem;
        }

        body.kid-mode .grade-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            padding: 1.5rem 3rem;
            margin: 1rem;
            border-radius: 20px;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transform: scale(1);
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        body.kid-mode .grade-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 20px rgba(0,0,0,0.2);
        }

        body.kid-mode .grade-btn.kindergarten {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
        }

        body.kid-mode .grade-btn.first-grade {
            background: linear-gradient(45deg, #a8edea, #fed6e3);
        }

		body.kid-mode .subjects-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			grid-template-rows: repeat(2, 1fr);
			gap: 2rem;
			margin-top: 2rem;
			max-width: 800px;
			margin-left: auto;
			margin-right: auto;
		}

        body.kid-mode .subject-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            transform: scale(1);
        }

        body.kid-mode .subject-card:hover {
            transform: scale(1.05) translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        body.kid-mode .subject-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        body.kid-mode .subject-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }

        /* Parent Mode Styles */
        body.parent-mode {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        body.parent-mode .grade-selector {
            margin-bottom: 2rem;
        }

        body.parent-mode .grade-dropdown {
            padding: 0.75rem;
            font-size: 1rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
        }

        body.parent-mode .parent-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        body.parent-mode .parent-btn {
            background: #4a5568;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        body.parent-mode .parent-btn:hover {
            background: #2d3748;
        }

        body.parent-mode .subjects-list {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        body.parent-mode .subject-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        body.parent-mode .subject-item:hover {
            background: #f7fafc;
        }

        .lesson-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .activity-area {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
            margin: 1rem 0;
            text-align: center;
        }

        .draggable {
            display: inline-block;
            padding: 1rem 1.5rem;
            margin: 0.5rem;
            background: linear-gradient(45deg, #ffd93d, #ffb347);
            border-radius: 15px;
            cursor: move;
            user-select: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            border: 3px solid #fff;
            transform: scale(1);
            transition: all 0.3s ease;
        }

        .draggable:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .drop-zone {
            min-height: 80px;
            border: 4px dashed #ccc;
            border-radius: 15px;
            margin: 1rem;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            background: rgba(255, 255, 255, 0.5);
        }

        .drop-zone.drag-over {
            border-color: #5a67d8;
            background: rgba(90, 103, 216, 0.2);
            transform: scale(1.05);
        }

        .quiz-option {
            background: linear-gradient(45deg, #e2e8f0, #cbd5e0);
            border: none;
            padding: 1.5rem 2rem;
            margin: 0.5rem;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            transform: scale(1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .quiz-option:hover {
            background: linear-gradient(45deg, #cbd5e0, #a0aec0);
            transform: scale(1.05);
        }

        .quiz-option.correct {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            animation: celebrate 0.6s ease;
        }

        .quiz-option.incorrect {
            background: linear-gradient(45deg, #f56565, #e53e3e);
            color: white;
            animation: shake 0.5s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1.05); }
            50% { transform: scale(1.2) rotate(5deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback-area {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 2rem;
            margin: 1rem 0;
            text-align: center;
            font-size: 1.5rem;
            transform: scale(0);
            transition: all 0.5s ease;
        }

        .feedback-area.show {
            transform: scale(1);
        }

        .feedback-area.correct {
            background: linear-gradient(45deg, #48bb78, #38a169);
        }

        .feedback-area.incorrect {
            background: linear-gradient(45deg, #f56565, #e53e3e);
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            width: 0%;
            transition: width 0.8s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .back-btn, .next-btn, .check-btn {
            background: linear-gradient(45deg, #5a67d8, #4c51bf);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 15px;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            transform: scale(1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .back-btn:hover, .next-btn:hover, .check-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .lesson-header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .lesson-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .lesson-description {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.5rem;
            color: #5a67d8;
        }

        @media (max-width: 768px) {
            body.kid-mode .grade-btn {
                padding: 1rem 2rem;
                font-size: 1.5rem;
                margin: 0.5rem;
            }
            
			body.kid-mode .subjects-grid {
				grid-template-columns: 1fr;
				grid-template-rows: auto;
				max-width: 400px;
			}
            
            .container {
                padding: 1rem;
            }

            .welcome-title {
                font-size: 2rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="kid-mode">
    <div class="header">
        <div class="logo">üåü Little Learners Academy</div>
        <button class="mode-toggle" onclick="toggleMode()">Switch to Parent Mode</button>
    </div>

    <div class="container">
        <!-- Welcome Page -->
        <div id="welcome-page" class="welcome-page">
            <h1 class="welcome-title">üåü Welcome to Little Learners Academy! üåü</h1>
            <p class="welcome-subtitle">A fun and interactive learning platform for young minds</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üéÆ</div>
                    <h3>Interactive Learning</h3>
                    <p>Drag, drop, click and play your way through lessons!</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìö</div>
                    <h3>Complete Curriculum</h3>
                    <p>Math, Reading, Science, and Art lessons for K-1st grade</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <h3>Parent Friendly</h3>
                    <p>Easy mode switching, progress tracking, and printable resources</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üèÜ</div>
                    <h3>Track Progress</h3>
                    <p>See how well you're doing with visual progress bars and celebrations!</p>
                </div>
            </div>

            <div style="margin: 2rem 0; padding: 2rem; background: rgba(90, 103, 216, 0.1); border-radius: 15px;">
                <h3 style="color: #5a67d8; margin-bottom: 1rem;">How It Works:</h3>
                <p style="font-size: 1.1rem; line-height: 1.6; color: #333;">
                    1. Choose your grade level (Kindergarten or 1st Grade)<br>
                    2. Pick a subject you want to learn<br>
                    3. Complete fun, interactive lessons<br>
                    4. Track your progress and celebrate achievements!<br>
                    <br>
                    <strong>Parents:</strong> Use "Parent Mode" to access answer keys, progress reports, and printable worksheets!
                </p>
            </div>

            <button class="start-button" onclick="startLearning()">
                üöÄ Let's Start Learning! üöÄ
            </button>
        </div>

        <!-- Grade Selection -->
        <div id="grade-selection" class="grade-selector hidden">
            <!-- Kid Mode Grade Selection -->
            <div class="kid-grade-selection">
                <h1 style="text-align: center; color: white; font-size: 2.5rem; margin-bottom: 2rem;">Choose Your Grade!</h1>
                <div style="text-align: center;">
                    <button class="grade-btn kindergarten" onclick="selectGrade('K')">
                        üåà Kindergarten
                    </button>
                    <button class="grade-btn first-grade" onclick="selectGrade('1')">
                        üöÄ 1st Grade
                    </button>
                </div>
            </div>

            <!-- Parent Mode Grade Selection -->
            <div class="parent-grade-selection hidden">
                <h2 style="margin-bottom: 1rem;">Select Grade Level</h2>
                <select class="grade-dropdown" onchange="selectGradeParent(this.value)">
                    <option value="">Choose Grade...</option>
                    <option value="K">Kindergarten</option>
                    <option value="1">1st Grade</option>
                </select>
            </div>
        </div>

        <!-- Parent Controls -->
        <div id="parent-controls" class="parent-controls hidden">
            <button class="parent-btn" onclick="showAnswerKey()">üìã Answer Keys</button>
            <button class="parent-btn" onclick="showProgress()">üìä Progress Report</button>
            <button class="parent-btn" onclick="printWorksheet()">üñ®Ô∏è Print Worksheets</button>
            <button class="parent-btn" onclick="showLessonPlans()">üìö Lesson Plans</button>
        </div>

        <!-- Subject Selection -->
        <div id="subject-selection" class="hidden">
            <button class="back-btn" onclick="showGradeSelection()">‚Üê Back to Grade Selection</button>
            
            <!-- Kid Mode Subjects -->
            <div class="subjects-grid">
                <div class="subject-card" onclick="selectSubject('math')">
                    <div class="subject-icon">üî¢</div>
                    <div class="subject-title">Math Fun</div>
                    <div>Numbers and counting!</div>
                </div>
                <div class="subject-card" onclick="selectSubject('reading')">
                    <div class="subject-icon">üìö</div>
                    <div class="subject-title">Reading Adventure</div>
                    <div>Letters and words!</div>
                </div>
                <div class="subject-card" onclick="selectSubject('science')">
                    <div class="subject-icon">üî¨</div>
                    <div class="subject-title">Science Explorer</div>
                    <div>Discover amazing things!</div>
                </div>
                <div class="subject-card" onclick="selectSubject('art')">
                    <div class="subject-icon">üé®</div>
                    <div class="subject-title">Creative Arts</div>
                    <div>Draw and create!</div>
                </div>
            </div>

            <!-- Parent Mode Subjects -->
            <div class="subjects-list hidden">
                <h2>Curriculum Overview</h2>
                <div class="subject-item" onclick="selectSubject('math')">
                    <span>Mathematics</span>
                    <span id="math-count">Loading...</span>
                </div>
                <div class="subject-item" onclick="selectSubject('reading')">
                    <span>Reading & Language Arts</span>
                    <span id="reading-count">Loading...</span>
                </div>
                <div class="subject-item" onclick="selectSubject('science')">
                    <span>Science</span>
                    <span id="science-count">Loading...</span>
                </div>
                <div class="subject-item" onclick="selectSubject('art')">
                    <span>Creative Arts</span>
                    <span id="art-count">Loading...</span>
                </div>
            </div>
        </div>

        <!-- Lesson Content -->
        <div id="lesson-content" class="lesson-content hidden">
            <button class="back-btn" onclick="showSubjectSelection()">‚Üê Back to Subjects</button>
            <div id="lesson-area" class="loading">Loading lesson...</div>
        </div>
    </div>

    <script>
        let currentMode = 'kid';
        let currentGrade = '';
        let currentSubject = '';
        let currentLesson = 0;
        let currentQuestionIndex = 0;
        let lessonData = {};
        let userProgress = JSON.parse(localStorage.getItem('learner_progress') || '{}');
        let userAnswers = [];

        // Curriculum data - this would normally be loaded from external JSON files
        const curriculum = {
            K: {
                math: [
                    {
                        title: "Counting 1-5",
                        description: "Let's learn to count from 1 to 5!",
                        questions: [
                            {
                                type: "drag_drop",
                                question: "Drag the numbers to put them in order from smallest to biggest:",
                                items: ["3", "1", "5", "2", "4"],
                                correct_order: ["1", "2", "3", "4", "5"],
                                feedback_correct: "üåü Awesome! You put the numbers in the right order! üåü",
                                feedback_incorrect: "üí™ Close! Try putting the smallest number first, then the next smallest!"
                            },
                            {
                                type: "quiz",
                                question: "How many fingers am I holding up? ‚úã",
                                options: ["3", "5", "7"],
                                correct: 1,
                                feedback_correct: "üéâ Perfect! That's 5 fingers! üéâ",
                                feedback_incorrect: "ü§î Count again! Look at all the fingers on one hand!"
                            },
                            {
                                type: "quiz",
                                question: "What comes after the number 2?",
                                options: ["1", "3", "4"],
                                correct: 1,
                                feedback_correct: "‚≠ê Great job! 3 comes after 2! ‚≠ê",
                                feedback_incorrect: "üìö Think about counting: 1, 2, then what comes next?"
                            }
                        ]
                    },
                    {
                        title: "Simple Addition",
                        description: "Adding numbers together is fun!",
                        questions: [
                            {
                                type: "quiz",
                                question: "If you have 2 apples üçéüçé and get 1 more üçé, how many do you have?",
                                options: ["2", "3", "4"],
                                correct: 1,
                                feedback_correct: "üçé Excellent! 2 + 1 = 3 apples! üçé",
                                feedback_incorrect: "üßÆ Try counting all the apples together!"
                            },
                            {
                                type: "quiz",
                                question: "What is 1 + 1?",
                                options: ["1", "2", "3"],
                                correct: 1,
                                feedback_correct: "üëè Perfect! 1 + 1 = 2! üëè",
                                feedback_incorrect: "üî¢ Think: if you have 1 toy and get 1 more, how many toys do you have?"
                            }
                        ]
                    }
                ],
                reading: [
                    {
                        title: "Letter Recognition A-E",
                        description: "Let's learn the first 5 letters of the alphabet!",
                        questions: [
                            {
                                type: "quiz",
                                question: "Which letter comes after B?",
                                options: ["A", "C", "D"],
                                correct: 1,
                                feedback_correct: "üìö Super! C comes after B! üìö",
                                feedback_incorrect: "üî§ Remember: A, B, C... what comes next?"
                            },
                            {
                                type: "drag_drop",
                                question: "Put these letters in ABC order:",
                                items: ["C", "A", "E", "B", "D"],
                                correct_order: ["A", "B", "C", "D", "E"],
                                feedback_correct: "üåü Amazing! You know your ABCs! üåü",
                                feedback_incorrect: "üí≠ Remember the alphabet song: A-B-C-D-E!"
                            },
                            {
                                type: "quiz",
                                question: "What letter does 'Apple' start with? üçé",
                                options: ["B", "A", "C"],
                                correct: 1,
                                feedback_correct: "üçé Yes! Apple starts with A! üçé",
                                feedback_incorrect: "ü§î Say 'Apple' slowly... what sound do you hear first?"
                            }
                        ]
                    }
                ],
                science: [
                    {
                        title: "Animals and Their Homes",
                        description: "Where do different animals live?",
                        questions: [
                            {
                                type: "quiz",
                                question: "Where does a bird live? üê¶",
                                options: ["Underground", "In a nest", "In water"],
                                correct: 1,
                                feedback_correct: "üê¶ Perfect! Birds live in nests! üê¶",
                                feedback_incorrect: "üå≥ Think about where you see birds in trees!"
                            },
                            {
                                type: "quiz",
                                question: "Where do fish live? üêü",
                                options: ["In water", "On land", "In trees"],
                                correct: 0,
                                feedback_correct: "üêü Great! Fish live in water! üêü",
                                feedback_incorrect: "üíß Think about where you would see fish swimming!"
                            }
                        ]
                    }
                ],
                art: [
                    {
                        title: "Colors and Shapes",
                        description: "Let's learn about basic colors and shapes!",
                        questions: [
                            {
                                type: "quiz",
                                question: "What color do you get when you mix red and yellow?",
                                options: ["Green", "Orange", "Purple"],
                                correct: 1,
                                feedback_correct: "üé® Wonderful! Red + Yellow = Orange! üé®",
                                feedback_incorrect: "üåà Think about the color of an orange fruit!"
                            },
                            {
                                type: "quiz",
                                question: "How many sides does a triangle have?",
                                options: ["2", "3", "4"],
                                correct: 1,
                                feedback_correct: "üìê Excellent! A triangle has 3 sides! üìê",
                                feedback_incorrect: "üî∫ Count the sides of this triangle shape: ‚ñ≥"
                            }
                        ]
                    }
                ]
            },
            1: {
                math: [
                    {
                        title: "Addition to 10",
                        description: "Adding bigger numbers up to 10!",
                        questions: [
                            {
                                type: "quiz",
                                question: "What is 7 + 2?",
                                options: ["8", "9", "10"],
                                correct: 1,
                                feedback_correct: "üéâ Perfect! 7 + 2 = 9! üéâ",
                                feedback_incorrect: "üî¢ Try counting up from 7: 7, 8, 9..."
                            },
                            {
                                type: "quiz",
                                question: "What is 5 + 5?",
                                options: ["9", "10", "11"],
                                correct: 1,
                                feedback_correct: "‚≠ê Great! 5 + 5 = 10! ‚≠ê",
                                feedback_incorrect: "‚úã Think about 5 fingers plus 5 more fingers!"
                            },
                            {
                                type: "quiz",
                                question: "What is 6 + 3?",
                                options: ["8", "9", "10"],
                                correct: 1,
                                feedback_correct: "üåü Awesome! 6 + 3 = 9! üåü",
                                feedback_incorrect: "üìä Try counting: 6, 7, 8, 9..."
                            }
                        ]
                    }
                ],
                reading: [
                   {
                       title: "Simple Words",
                       description: "Reading simple 3-letter words!",
                       questions: [
                           {
                               type: "quiz",
                               question: "What word is this: C-A-T?",
                               options: ["Dog", "Cat", "Bird"],
                               correct: 1,
                               feedback_correct: "üê± Perfect! C-A-T spells CAT! üê±",
                               feedback_incorrect: "üìñ Sound it out: C-A-T... what animal says meow?"
                           },
                           {
                               type: "quiz",
                               question: "What word is this: D-O-G?",
                               options: ["Cat", "Dog", "Fish"],
                               correct: 1,
                               feedback_correct: "üê∂ Great! D-O-G spells DOG! üê∂",
                               feedback_incorrect: "üî§ Sound it out: D-O-G... what animal barks?"
                           },
                           {
                               type: "quiz",
                               question: "Which word rhymes with 'hat'?",
                               options: ["Dog", "Cat", "Fish"],
                               correct: 1,
                               feedback_correct: "üé© Excellent! Hat and Cat rhyme! üé©",
                               feedback_incorrect: "üéµ Think about words that sound like 'hat' at the end!"
                           }
                       ]
                   }
               ],
               science: [
                   {
                       title: "Weather and Seasons",
                       description: "Learning about different types of weather!",
                       questions: [
                           {
                               type: "quiz",
                               question: "What do you use when it's raining? ‚òî",
                               options: ["Sunglasses", "Umbrella", "Shorts"],
                               correct: 1,
                               feedback_correct: "‚òî Perfect! An umbrella keeps you dry! ‚òî",
                               feedback_incorrect: "üåßÔ∏è Think about what keeps rain off you!"
                           },
                           {
                               type: "quiz",
                               question: "When do leaves fall from trees? üçÇ",
                               options: ["Spring", "Summer", "Fall"],
                               correct: 2,
                               feedback_correct: "üçÇ Great! Leaves fall in the Fall season! üçÇ",
                               feedback_incorrect: "üå≥ Think about which season is also called 'Autumn'!"
                           },
                           {
                               type: "quiz",
                               question: "What helps plants grow? üå±",
                               options: ["Darkness", "Sunlight", "Cold"],
                               correct: 1,
                               feedback_correct: "‚òÄÔ∏è Wonderful! Plants need sunlight to grow! ‚òÄÔ∏è",
                               feedback_incorrect: "üåû Think about what makes plants happy and green!"
                           }
                       ]
                   }
               ],
               art: [
                   {
                       title: "Drawing and Creating",
                       description: "Learn about art and creativity!",
                       questions: [
                           {
                               type: "quiz",
                               question: "What are the three primary colors?",
                               options: ["Red, Blue, Yellow", "Green, Orange, Purple", "Black, White, Gray"],
                               correct: 0,
                               feedback_correct: "üé® Perfect! Red, Blue, and Yellow are primary colors! üé®",
                               feedback_incorrect: "üåà Think about the colors you can't make by mixing other colors!"
                           },
                           {
                               type: "quiz",
                               question: "What tool do you use to paint?",
                               options: ["Spoon", "Paintbrush", "Fork"],
                               correct: 1,
                               feedback_correct: "üñåÔ∏è Great! A paintbrush is for painting! üñåÔ∏è",
                               feedback_incorrect: "üé® Think about what artists use to put paint on paper!"
                           },
                           {
                               type: "quiz",
                               question: "How many sides does a square have?",
                               options: ["3", "4", "5"],
                               correct: 1,
                               feedback_correct: "‚¨ú Excellent! A square has 4 equal sides! ‚¨ú",
                               feedback_incorrect: "üìê Count the sides of this square: ‚¨ú"
                           }
                       ]
                   }
               ]
           }
       };

       function startLearning() {
           document.getElementById('welcome-page').classList.add('hidden');
           document.getElementById('grade-selection').classList.remove('hidden');
       }

       function toggleMode() {
           const body = document.body;
           const toggleBtn = document.querySelector('.mode-toggle');
           
           if (currentMode === 'kid') {
               body.className = 'parent-mode';
               toggleBtn.textContent = 'Switch to Kid Mode';
               currentMode = 'parent';
               updateModeDisplay();
           } else {
               body.className = 'kid-mode';
               toggleBtn.textContent = 'Switch to Parent Mode';
               currentMode = 'kid';
               updateModeDisplay();
           }
       }

       function updateModeDisplay() {
           const kidElements = document.querySelectorAll('.kid-grade-selection, .subjects-grid');
           const parentElements = document.querySelectorAll('.parent-grade-selection, .subjects-list, #parent-controls');
           
           if (currentMode === 'kid') {
               kidElements.forEach(el => el.classList.remove('hidden'));
               parentElements.forEach(el => el.classList.add('hidden'));
           } else {
               kidElements.forEach(el => el.classList.add('hidden'));
               parentElements.forEach(el => el.classList.remove('hidden'));
               updateParentLessonCounts();
           }
       }

       function updateParentLessonCounts() {
           if (currentGrade && curriculum[currentGrade]) {
               const subjects = ['math', 'reading', 'science', 'art'];
               subjects.forEach(subject => {
                   const count = curriculum[currentGrade][subject]?.length || 0;
                   const element = document.getElementById(`${subject}-count`);
                   if (element) {
                       element.textContent = `${count} lessons available`;
                   }
               });
           }
       }

       function selectGrade(grade) {
           currentGrade = grade;
           showSubjectSelection();
       }

       function selectGradeParent(grade) {
           if (grade) {
               currentGrade = grade;
               showSubjectSelection();
           }
       }

       function showGradeSelection() {
           document.getElementById('grade-selection').classList.remove('hidden');
           document.getElementById('subject-selection').classList.add('hidden');
           document.getElementById('lesson-content').classList.add('hidden');
           document.getElementById('welcome-page').classList.add('hidden');
       }

       function showSubjectSelection() {
           document.getElementById('grade-selection').classList.add('hidden');
           document.getElementById('subject-selection').classList.remove('hidden');
           document.getElementById('lesson-content').classList.add('hidden');
           document.getElementById('welcome-page').classList.add('hidden');
           updateModeDisplay();
       }

       function selectSubject(subject) {
           currentSubject = subject;
           currentLesson = 0;
           currentQuestionIndex = 0;
           userAnswers = [];
           showLesson();
       }

       function showLesson() {
           document.getElementById('subject-selection').classList.add('hidden');
           document.getElementById('lesson-content').classList.remove('hidden');
           loadLesson();
       }

       function loadLesson() {
           const lessonArea = document.getElementById('lesson-area');
           const lessons = curriculum[currentGrade]?.[currentSubject] || [];
           
           if (currentLesson < lessons.length) {
               const lesson = lessons[currentLesson];
               lessonData = lesson;
               currentQuestionIndex = 0;
               userAnswers = [];
               lessonArea.innerHTML = generateLessonHTML(lesson);
               loadQuestion();
           } else {
               lessonArea.innerHTML = `
                   <div class="lesson-header">
                       <h2 class="lesson-title">üéâ Congratulations! üéâ</h2>
                       <p class="lesson-description">You completed all ${currentSubject} lessons!</p>
                   </div>
                   <div style="text-align: center;">
                       <button class="next-btn" onclick="showSubjectSelection()">Choose Another Subject</button>
                   </div>
               `;
           }
       }

       function generateLessonHTML(lesson) {
           const totalQuestions = lesson.questions.length;
           const progress = currentLesson / curriculum[currentGrade][currentSubject].length * 100;
           
           return `
               <div class="lesson-header">
                   <h2 class="lesson-title">${lesson.title}</h2>
                   <p class="lesson-description">${lesson.description}</p>
               </div>
               <div class="progress-bar">
                   <div class="progress-fill" style="width: ${progress}%"></div>
               </div>
               <div id="question-area"></div>
               <div id="feedback-area" class="feedback-area"></div>
               <div style="text-align: center; margin-top: 2rem;">
                   <span style="font-size: 1.2rem; color: #5a67d8;">
                       Question <span id="question-counter">1</span> of ${totalQuestions}
                   </span>
               </div>
           `;
       }

       function loadQuestion() {
           if (!lessonData || !lessonData.questions) return;
           
           const question = lessonData.questions[currentQuestionIndex];
           const questionArea = document.getElementById('question-area');
           const feedbackArea = document.getElementById('feedback-area');
           const questionCounter = document.getElementById('question-counter');
           
           if (questionCounter) {
               questionCounter.textContent = currentQuestionIndex + 1;
           }
           
           // Clear previous feedback
           feedbackArea.classList.remove('show', 'correct', 'incorrect');
           
           let html = `
               <div class="activity-area">
                   <h3 style="font-size: 1.5rem; margin-bottom: 1.5rem;">${question.question}</h3>
           `;

           if (question.type === 'quiz') {
               question.options.forEach((option, index) => {
                   html += `<button class="quiz-option" onclick="checkQuizAnswer(${index})">${option}</button>`;
               });
           } else if (question.type === 'drag_drop') {
               html += '<div id="drag-items" style="margin-bottom: 2rem;">';
               question.items.forEach((item, index) => {
                   html += `<span class="draggable" draggable="true" data-value="${item}">${item}</span>`;
               });
               html += '</div>';
               html += '<div id="drop-zones" style="margin-bottom: 2rem;">';
               for (let i = 0; i < question.correct_order.length; i++) {
                   html += `<div class="drop-zone" data-position="${i}">Drop ${i + 1}</div>`;
               }
               html += '</div>';
               html += '<button class="check-btn" onclick="checkDragDrop()">Check My Answer!</button>';
           }

           html += '</div>';
           questionArea.innerHTML = html;
           
           // Initialize drag and drop if needed
           if (question.type === 'drag_drop') {
               initializeDragDrop();
           }
       }

       function checkQuizAnswer(selectedIndex) {
           const question = lessonData.questions[currentQuestionIndex];
           const options = document.querySelectorAll('.quiz-option');
           const feedbackArea = document.getElementById('feedback-area');
           
           // Disable all options
           options.forEach(option => option.disabled = true);
           
           if (selectedIndex === question.correct) {
               options[selectedIndex].classList.add('correct');
               showFeedback(question.feedback_correct, true);
               userAnswers[currentQuestionIndex] = true;
               updateProgress();
               setTimeout(() => {
                   nextQuestion();
               }, 2000);
           } else {
               options[selectedIndex].classList.add('incorrect');
               showFeedback(question.feedback_incorrect, false);
               userAnswers[currentQuestionIndex] = false;
               setTimeout(() => {
                   // Re-enable options for retry
                   options.forEach(option => {
                       option.disabled = false;
                       option.classList.remove('incorrect');
                   });
                   hideFeeback();
               }, 2000);
           }
       }

       function initializeDragDrop() {
           const draggables = document.querySelectorAll('.draggable');
           const dropZones = document.querySelectorAll('.drop-zone');

           draggables.forEach(draggable => {
               draggable.addEventListener('dragstart', e => {
                   e.dataTransfer.setData('text/plain', e.target.dataset.value);
                   e.target.style.opacity = '0.5';
               });

               draggable.addEventListener('dragend', e => {
                   e.target.style.opacity = '1';
               });
           });

           dropZones.forEach(zone => {
               zone.addEventListener('dragover', e => {
                   e.preventDefault();
                   zone.classList.add('drag-over');
               });

               zone.addEventListener('dragleave', e => {
                   zone.classList.remove('drag-over');
               });

               zone.addEventListener('drop', e => {
                   e.preventDefault();
                   const data = e.dataTransfer.getData('text/plain');
                   zone.textContent = data;
                   zone.classList.remove('drag-over');
                   zone.style.background = 'rgba(72, 187, 120, 0.2)';
               });
           });
       }

       function checkDragDrop() {
           const question = lessonData.questions[currentQuestionIndex];
           const dropZones = document.querySelectorAll('.drop-zone');
           let correct = true;
           let userOrder = [];

           dropZones.forEach((zone, index) => {
               const value = zone.textContent.replace('Drop ' + (index + 1), '').trim();
               userOrder.push(value);
               if (value !== question.correct_order[index]) {
                   correct = false;
               }
           });

           if (correct && userOrder.every(val => val !== '')) {
               showFeedback(question.feedback_correct, true);
               userAnswers[currentQuestionIndex] = true;
               updateProgress();
               setTimeout(() => {
                   nextQuestion();
               }, 2000);
           } else {
               showFeedback(question.feedback_incorrect, false);
               userAnswers[currentQuestionIndex] = false;
               // Reset drop zones after a delay
               setTimeout(() => {
                   dropZones.forEach(zone => {
                       const position = zone.dataset.position;
                       zone.textContent = `Drop ${parseInt(position) + 1}`;
                       zone.style.background = 'rgba(255, 255, 255, 0.5)';
                   });
                   hideFeeback();
               }, 2000);
           }
       }

       function showFeedback(message, isCorrect) {
           const feedbackArea = document.getElementById('feedback-area');
           feedbackArea.textContent = message;
           feedbackArea.classList.add('show');
           feedbackArea.classList.add(isCorrect ? 'correct' : 'incorrect');
       }

       function hideFeeback() {
           const feedbackArea = document.getElementById('feedback-area');
           feedbackArea.classList.remove('show', 'correct', 'incorrect');
       }

       function nextQuestion() {
           currentQuestionIndex++;
           if (currentQuestionIndex < lessonData.questions.length) {
               loadQuestion();
           } else {
               // Lesson complete
               completeLesson();
           }
       }

       function completeLesson() {
           const questionArea = document.getElementById('question-area');
           const feedbackArea = document.getElementById('feedback-area');
           const correctAnswers = userAnswers.filter(answer => answer === true).length;
           const totalQuestions = lessonData.questions.length;
           const percentage = Math.round((correctAnswers / totalQuestions) * 100);
           
           feedbackArea.classList.remove('show');
           
           questionArea.innerHTML = `
               <div style="text-align: center; padding: 2rem;">
                   <h2 style="color: #48bb78; font-size: 2.5rem; margin-bottom: 1rem;">üéâ Lesson Complete! üéâ</h2>
                   <p style="font-size: 1.5rem; margin-bottom: 2rem;">
                       You got ${correctAnswers} out of ${totalQuestions} questions correct! (${percentage}%)
                   </p>
                   <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                       <button class="next-btn" onclick="nextLesson()">Next Lesson ‚Üí</button>
                       <button class="back-btn" onclick="showSubjectSelection()">Back to Subjects</button>
                   </div>
               </div>
           `;
       }

       function nextLesson() {
           const lessons = curriculum[currentGrade]?.[currentSubject] || [];
           if (currentLesson < lessons.length - 1) {
               currentLesson++;
               currentQuestionIndex = 0;
               userAnswers = [];
               loadLesson();
           } else {
               showSubjectSelection();
           }
       }

       function updateProgress() {
           if (!userProgress[currentGrade]) {
               userProgress[currentGrade] = {};
           }
           if (!userProgress[currentGrade][currentSubject]) {
               userProgress[currentGrade][currentSubject] = [];
           }
           
           userProgress[currentGrade][currentSubject][currentLesson] = true;
           localStorage.setItem('learner_progress', JSON.stringify(userProgress));
       }

       function showAnswerKey() {
           let answerKey = `Answer Key for Grade ${currentGrade}:\n\n`;
           if (curriculum[currentGrade]) {
               for (let subject in curriculum[currentGrade]) {
                   answerKey += `${subject.toUpperCase()}:\n`;
                   curriculum[currentGrade][subject].forEach((lesson, lessonIndex) => {
                       answerKey += `  Lesson ${lessonIndex + 1}: ${lesson.title}\n`;
                       lesson.questions.forEach((question, questionIndex) => {
                           answerKey += `    Q${questionIndex + 1}: `;
                           if (question.type === 'quiz') {
                               answerKey += `${question.options[question.correct]}\n`;
                           } else if (question.type === 'drag_drop') {
                               answerKey += `${question.correct_order.join(', ')}\n`;
                           }
                       });
                   });
                   answerKey += '\n';
               }
           }
           
           // Create a modal-like display instead of alert
           const modal = document.createElement('div');
           modal.style.cssText = `
               position: fixed; top: 0; left: 0; width: 100%; height: 100%;
               background: rgba(0,0,0,0.8); z-index: 1000; padding: 2rem;
               display: flex; align-items: center; justify-content: center;
           `;
           modal.innerHTML = `
               <div style="background: white; padding: 2rem; border-radius: 15px; max-width: 600px; max-height: 80%; overflow-y: auto;">
                   <h2>Answer Key</h2>
                   <pre style="white-space: pre-wrap; font-family: Arial, sans-serif;">${answerKey}</pre>
                   <button onclick="this.closest('div').parentElement.remove()" style="background: #5a67d8; color: white; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; margin-top: 1rem;">Close</button>
               </div>
           `;
           document.body.appendChild(modal);
       }

       function showProgress() {
           let progressReport = `Progress Report:\n\n`;
           for (let grade in userProgress) {
               progressReport += `Grade ${grade}:\n`;
               for (let subject in userProgress[grade]) {
                   const completed = userProgress[grade][subject].filter(Boolean).length;
                   const total = curriculum[grade]?.[subject]?.length || 0;
                   const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
                   progressReport += `  ${subject}: ${completed}/${total} lessons (${percentage}%)\n`;
               }
               progressReport += '\n';
           }
           
           // Create a modal-like display instead of alert
           const modal = document.createElement('div');
           modal.style.cssText = `
               position: fixed; top: 0; left: 0; width: 100%; height: 100%;
               background: rgba(0,0,0,0.8); z-index: 1000; padding: 2rem;
               display: flex; align-items: center; justify-content: center;
           `;
           modal.innerHTML = `
               <div style="background: white; padding: 2rem; border-radius: 15px; max-width: 600px; max-height: 80%; overflow-y: auto;">
                   <h2>Progress Report</h2>
                   <pre style="white-space: pre-wrap; font-family: Arial, sans-serif;">${progressReport || 'No progress recorded yet.'}</pre>
                   <button onclick="this.closest('div').parentElement.remove()" style="background: #5a67d8; color: white; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; margin-top: 1rem;">Close</button>
               </div>
           `;
           document.body.appendChild(modal);
       }

       function printWorksheet() {
           window.print();
       }

       function showLessonPlans() {
           let lessonPlans = `Lesson Plans for Grade ${currentGrade}:\n\n`;
           if (curriculum[currentGrade]) {
               for (let subject in curriculum[currentGrade]) {
                   lessonPlans += `${subject.toUpperCase()} CURRICULUM:\n`;
                   curriculum[currentGrade][subject].forEach((lesson, index) => {
                       lessonPlans += `\nLesson ${index + 1}: ${lesson.title}\n`;
                       lessonPlans += `Description: ${lesson.description}\n`;
                       lessonPlans += `Questions: ${lesson.questions.length}\n`;
                       lessonPlans += `Learning Objectives:\n`;
                       if (subject === 'math') {
                           lessonPlans += `  - Number recognition and counting\n  - Basic arithmetic skills\n`;
                       } else if (subject === 'reading') {
                           lessonPlans += `  - Letter recognition\n  - Phonics and word formation\n`;
                       } else if (subject === 'science') {
                           lessonPlans += `  - Observation skills\n  - Understanding the natural world\n`;
                       } else if (subject === 'art') {
                           lessonPlans += `  - Color recognition\n  - Shape identification\n  - Creative expression\n`;
                       }
                   });
                   lessonPlans += '\n---\n';
               }
           }
           
           // Create a modal-like display instead of alert
           const modal = document.createElement('div');
           modal.style.cssText = `
               position: fixed; top: 0; left: 0; width: 100%; height: 100%;
               background: rgba(0,0,0,0.8); z-index: 1000; padding: 2rem;
               display: flex; align-items: center; justify-content: center;
           `;
           modal.innerHTML = `
               <div style="background: white; padding: 2rem; border-radius: 15px; max-width: 800px; max-height: 80%; overflow-y: auto;">
                   <h2>Lesson Plans & Teaching Guide</h2>
                   <pre style="white-space: pre-wrap; font-family: Arial, sans-serif; font-size: 0.9rem;">${lessonPlans}</pre>
                   <button onclick="this.closest('div').parentElement.remove()" style="background: #5a67d8; color: white; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; margin-top: 1rem;">Close</button>
               </div>
           `;
           document.body.appendChild(modal);
       }

       // Initialize mode display on load
       updateModeDisplay();
   </script>
</body>
</html>