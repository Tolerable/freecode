<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>YOU for President - Campaign Poster Builder</title>

<style>
  :root {
    --app-bg:#0f172a;
    --panel:#111827;
    --panelEdge:#1f2937;
    --card:#1e293b;
    --text-main:#f8fafc;
    --text-dim:#94a3b8;
    --border:#4b5563;
    --accent:#38bdf8;
    --radius-xl:1rem;
    --radius-lg:.75rem;
    --radius-md:.5rem;
  }

  * {
    box-sizing:border-box;
  }

  body {
    margin:0;
    background:var(--app-bg);
    color:var(--text-main);
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,"Helvetica Neue",sans-serif;
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }

  /***** HEADER BAR *****/
  header {
    border-bottom:1px solid var(--panelEdge);
    background:
      radial-gradient(circle at 20% 20%,rgba(56,189,248,.25) 0%,rgba(15,23,42,0) 60%),
      radial-gradient(circle at 80% 20%,rgba(56,189,248,.12) 0%,rgba(15,23,42,0) 60%),
      var(--panel);
    padding:1rem 1.5rem;
    display:flex;
    flex-wrap:wrap;
    align-items:flex-start;
    gap:1rem;
  }

  header .title-group {
    flex:1;
    min-width:200px;
  }

  header h1 {
    margin:0;
    font-size:1.125rem;
    line-height:1.25rem;
    font-weight:600;
    color:var(--text-main);
    display:flex;
    align-items:center;
    gap:.5rem;
  }

  header h1 svg {
    width:1.25rem;
    height:1.25rem;
    flex-shrink:0;
  }

  header p {
    margin:.25rem 0 0;
    color:var(--text-dim);
    font-size:.8rem;
    line-height:1rem;
    max-width:600px;
  }

  header .actions {
    display:flex;
    flex-wrap:wrap;
    gap:.5rem;
  }

  button {
    cursor:pointer;
    border:0;
    font-size:.8rem;
    font-weight:600;
    line-height:1rem;
    color:var(--text-main);
    background:var(--panelEdge);
    padding:.6rem .8rem;
    border-radius:var(--radius-md);
    min-width:90px;
    box-shadow:0 8px 24px rgba(0,0,0,.6);
  }
  button.primary {
    background:var(--accent);
    color:#0a0a0a;
    font-weight:700;
  }
  button.danger {
    background:#b91c1c;
    color:#fff;
  }

  button.small {
    font-size:.7rem;
    padding:.5rem .6rem;
    min-width:auto;
  }

  /***** SHELL LAYOUT *****/
  main.app-shell {
    flex:1;
    min-height:0;
    display:flex;
    gap:1rem;
    padding:1rem;
  }

  /***** LEFT CONFIG PANEL *****/
  .config-panel {
    width:320px;
    max-width:320px;
    flex-shrink:0;
    background:var(--panel);
    border:1px solid var(--panelEdge);
    border-radius:var(--radius-xl);
    padding:1rem 1rem 5rem;
    box-shadow:0 24px 64px rgba(0,0,0,.9);
    display:flex;
    flex-direction:column;
    min-height:0;
    overflow:auto;
  }

  .config-section {
    background:var(--card);
    border:1px solid var(--panelEdge);
    border-radius:var(--radius-lg);
    padding:1rem;
    margin-bottom:1rem;
  }

  .config-section h2 {
    margin:0 0 .5rem;
    font-size:.8rem;
    line-height:1rem;
    font-weight:600;
    color:var(--text-main);
    display:flex;
    align-items:center;
    justify-content:space-between;
    flex-wrap:wrap;
    gap:.25rem;
  }

  .config-section h2 span.label {
    display:flex;
    align-items:center;
    gap:.4rem;
  }
  .config-section h2 span.sub {
    font-size:.7rem;
    font-weight:400;
    color:var(--text-dim);
  }

  .field {
    display:flex;
    flex-direction:column;
    margin-bottom:.75rem;
  }

  .field-row {
    display:flex;
    flex-wrap:wrap;
    gap:.5rem;
  }

  label {
    font-size:.7rem;
    font-weight:500;
    color:var(--text-dim);
    margin-bottom:.35rem;
    display:flex;
    align-items:center;
    justify-content:space-between;
    flex-wrap:wrap;
    gap:.5rem;
  }

  input[type="text"],
  select,
  textarea,
  input[type="color"] {
    width:100%;
    background:var(--panelEdge);
    color:var(--text-main);
    border:1px solid var(--border);
    border-radius:var(--radius-md);
    padding:.55rem .6rem;
    font-size:.8rem;
    line-height:1rem;
    font-family:inherit;
  }

  input[type="color"] {
    padding:.2rem;
    height:2rem;
    cursor:pointer;
  }

  textarea {
    resize:vertical;
    min-height:3rem;
    max-height:6rem;
  }

  .mini-note {
    font-size:.65rem;
    line-height:.8rem;
    color:var(--text-dim);
  }

  .two-cols {
    display:flex;
    flex-wrap:wrap;
    gap:.5rem;
  }

  .two-cols .col {
    flex:1;
    min-width:0;
  }

  .upload-row {
    background:var(--panelEdge);
    border:1px dashed var(--border);
    border-radius:var(--radius-md);
    padding:.6rem .6rem .75rem;
    font-size:.7rem;
    line-height:1rem;
    color:var(--text-dim);
    display:flex;
    flex-direction:column;
    gap:.5rem;
  }

  .upload-row div.titleline {
    font-weight:600;
    color:var(--text-main);
    font-size:.75rem;
    line-height:1rem;
  }

  .upload-row input[type="file"] {
    width:100%;
    font-size:.7rem;
    line-height:1rem;
    border:0;
    color:var(--text-main);
    background:none;
    padding:0;
  }

  .stance-row {
    display:flex;
    flex-direction:column;
    background:var(--panelEdge);
    border:1px solid var(--panelEdge);
    border-radius:var(--radius-md);
    padding:.6rem .6rem .75rem;
    margin-bottom:.5rem;
  }

  .stance-row .top {
    display:flex;
    gap:.5rem;
    flex-wrap:wrap;
    align-items:flex-start;
  }

  .stance-row select {
    flex:1;
    min-width:0;
  }

  .stance-row textarea {
    flex:1;
    min-width:0;
  }

  /***** RIGHT PREVIEW PANEL *****/
  .preview-wrapper {
    flex:1;
    min-width:0;
    min-height:0;
    background:var(--panel);
    border:1px solid var(--panelEdge);
    border-radius:var(--radius-xl);
    padding:1rem;
    box-shadow:0 24px 64px rgba(0,0,0,.9);
    display:flex;
    flex-direction:column;
    position:relative;
  }

  .preview-title-bar {
    display:flex;
    flex-wrap:wrap;
    align-items:flex-start;
    justify-content:space-between;
    margin-bottom:.75rem;
    gap:.75rem;
  }

  .preview-title-left {
    display:flex;
    flex-direction:column;
  }

  .preview-title-left h2 {
    margin:0;
    font-size:.8rem;
    line-height:1rem;
    font-weight:600;
    color:var(--text-main);
    display:flex;
    align-items:center;
    gap:.4rem;
  }

  .preview-title-left p {
    margin:.25rem 0 0;
    font-size:.7rem;
    line-height:.9rem;
    color:var(--text-dim);
  }

  .preview-title-right {
    display:flex;
    flex-wrap:wrap;
    gap:.5rem;
    color:var(--text-dim);
    font-size:.7rem;
    line-height:.9rem;
  }

  .poster-area-outer {
    flex:1;
    min-height:0;
    overflow:auto;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:1rem;
    background:repeating-linear-gradient(
      -45deg,
      rgba(56,189,248,.07) 0px,
      rgba(56,189,248,0) 4px,
      rgba(56,189,248,0) 8px,
      rgba(56,189,248,.07) 12px
    );
    border:1px solid var(--panelEdge);
    border-radius:var(--radius-lg);
  }

  /***** THE POSTER LAYOUT (PRINT TARGET) *****/
  /*
    We design at US Letter size: 8.5in x 11in.
    On-screen we clamp max-width:100% so it scales down.
  */
  .poster {
    width:8.5in;
    max-width:100%;
    min-height:11in;
    background:#ffffff;
    color:#000000;
    border:4px solid #000;
    border-radius:.25in;
    box-shadow:0 40px 80px rgba(0,0,0,.8);
    font-family:"Impact","Anton","Arial Black","Inter",system-ui,sans-serif;
    display:flex;
    flex-direction:column;
    overflow:hidden;
  }

  /***** POSTER HEADER BAND *****/
  .poster-header {
    padding:0.6in 0.4in 0.4in;
    background:#1e3a8a; /* gets overridden in JS */
    color:#fff;
    text-align:center;
    text-transform:uppercase;
    border-bottom:4px solid #000;
  }

  .poster-header .line-small {
    font-size:0.4in;
    line-height:0.45in;
    font-weight:800;
    letter-spacing:.03em;
  }

  .poster-header .line-big {
    margin-top:0.15in;
    font-size:0.7in;
    line-height:0.75in;
    font-weight:800;
    letter-spacing:.03em;
    word-break:break-word;
  }

  /***** POSTER BODY *****/
  .poster-body {
    flex:1;
    display:flex;
    flex-wrap:nowrap;
    padding:0.4in;
    gap:0.4in;
    background:#fff;
    color:#000;
  }

  .body-left {
    width:2.5in;
    max-width:2.5in;
    flex-shrink:0;
    text-align:center;
  }

  .candidate-pic {
    width:2.5in;
    height:2.5in;
    max-width:100%;
    max-height:100%;
    border:4px solid #000;
    border-radius:.3in;
    background:#ddd;
    background-size:cover;
    background-position:center;
    background-repeat:no-repeat;
  }

  .candidate-name {
    margin-top:0.3in;
    font-size:0.45in;
    line-height:0.5in;
    font-weight:800;
    text-transform:uppercase;
    word-break:break-word;
  }

  .body-right {
    flex:1;
    min-width:0;
    display:flex;
    flex-direction:column;
    border:4px solid #000;
    border-radius:.3in;
    background:#fff;
    padding:0.4in;
    font-family:"Inter",system-ui,sans-serif;
  }

  .headline {
    font-size:0.4in;
    line-height:0.45in;
    font-weight:800;
    text-align:center;
    text-transform:uppercase;
    margin-bottom:0.3in;
    word-break:break-word;
  }

  .stances-list {
    display:flex;
    flex-direction:column;
    gap:0.25in;
    font-size:0.18in;
    line-height:0.22in;
    font-weight:600;
    color:#000;
  }

  .stance-item {
    display:flex;
    align-items:flex-start;
    gap:0.2in;
  }

  .stance-icon {
    flex-shrink:0;
    min-width:0.5in;
    height:0.5in;
    border-radius:0.15in;
    background:#1e3a8a; /* JS changes */
    color:#fff;
    font-size:0.22in;
    line-height:0.5in;
    font-weight:800;
    text-align:center;
    border:3px solid #000;
  }

  .stance-text {
    flex:1;
    min-width:0;
  }

  .stance-title {
    font-size:0.22in;
    line-height:0.25in;
    font-weight:800;
    text-transform:uppercase;
    word-break:break-word;
  }

  .stance-desc {
    font-size:0.18in;
    line-height:0.22in;
    font-weight:500;
    margin-top:0.05in;
    word-break:break-word;
  }

  .vp-box {
    margin-top:0.4in;
    display:flex;
    flex-wrap:nowrap;
    align-items:flex-start;
    gap:0.3in;
  }

  .vp-pic {
    width:1.5in;
    height:1.5in;
    border:4px solid #000;
    border-radius:.2in;
    background:#ddd;
    background-size:cover;
    background-position:center;
    background-repeat:no-repeat;
    flex-shrink:0;
  }

  .vp-info {
    flex:1;
    min-width:0;
  }

  .vp-role {
    font-family:"Impact","Anton","Arial Black","Inter",system-ui,sans-serif;
    font-size:0.22in;
    line-height:0.25in;
    font-weight:800;
    color:#000;
    text-transform:uppercase;
  }

  .vp-name {
    margin-top:0.05in;
    font-family:"Impact","Anton","Arial Black","Inter",system-ui,sans-serif;
    font-size:0.3in;
    line-height:0.35in;
    font-weight:800;
    color:#000;
    text-transform:uppercase;
    word-break:break-word;
  }

  /***** POSTER FOOTER BAND *****/
  .poster-footer {
    border-top:4px solid #000;
    background:#b91c1c; /* JS changes */
    color:#fff;
    text-align:center;
    text-transform:uppercase;
    padding:0.4in;
    font-weight:800;
  }

  .footer-partyline {
    font-size:0.35in;
    line-height:0.4in;
    word-break:break-word;
  }

  .slogan {
    margin-top:0.2in;
    font-size:0.32in;
    line-height:0.36in;
    word-break:break-word;
  }

  .legal-note {
    margin-top:0.25in;
    font-size:0.17in;
    line-height:0.2in;
    font-weight:600;
    font-family:"Inter",system-ui,sans-serif;
    color:#fff;
    text-transform:none;
  }

  /***** LIVE SCREEN (FULL PAGE POSTER VIEW) *****/
  .live-screen {
    position:fixed;
    inset:0;
    background:#ffffff;
    color:#000;
    display:none;
    flex-direction:column;
    z-index:9999;
  }

  .live-toolbar {
    background:#000;
    color:#fff;
    padding:.75rem 1rem;
    font-size:.8rem;
    line-height:1rem;
    font-weight:600;
    display:flex;
    flex-wrap:wrap;
    align-items:flex-start;
    gap:.5rem;
  }

  .live-toolbar button {
    box-shadow:none;
    border-radius:var(--radius-md);
  }

  .live-frame {
    flex:1;
    min-height:0;
    overflow:auto;
    background:#fff;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:1rem;
  }

  /* PRINT CLEANUP */
  @media print {
    @page {
      size:Letter portrait;
      margin:0;
    }

    body {
      background:#fff !important;
      color:#000 !important;
    }

    header,
    main.app-shell,
    .live-toolbar {
      display:none !important;
    }

    .live-screen {
      position:static !important;
      inset:auto !important;
      padding:0 !important;
      background:#fff !important;
      display:block !important;
    }

    .live-frame {
      padding:0 !important;
      border:0 !important;
      box-shadow:none !important;
    }

    .poster {
      width:8.5in !important;
      min-height:11in !important;
      max-width:100% !important;
      border-radius:0 !important;
      box-shadow:none !important;
      border:4px solid #000 !important;
    }
  }

  /***** SMALL SCREENS *****/
  @media (max-width:900px){
    main.app-shell {
      flex-direction:column;
    }
    .config-panel {
      width:100%;
      max-width:none;
      order:2;
    }
    .preview-wrapper {
      order:1;
      min-height:400px;
    }
  }
</style>
</head>
<body>

<header>
  <div class="title-group">
    <h1>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2v4"></path>
        <path d="M12 18v4"></path>
        <path d="M4 12h4"></path>
        <path d="M16 12h4"></path>
        <circle cx="12" cy="12" r="4"></circle>
      </svg>
      YOU for President
    </h1>
    <p>
      Make a full-page campaign poster. Pick colors, party name, stance lines,
      your face, your VP. Then “GO LIVE”, hit Print → Save as PDF. The final page
      looks like a real poster (no editor junk).
    </p>
  </div>

  <div class="actions">
    <button class="primary" id="btnGoLive">GO LIVE / PRINT VIEW</button>
    <button class="danger small" id="btnClear">Reset All</button>
  </div>
</header>

<main class="app-shell">
  <!-- CONFIG PANEL -->
  <aside class="config-panel" id="configPanel">

    <!-- BASIC INFO -->
    <section class="config-section">
      <h2>
        <span class="label">Basic Info</span>
        <span class="sub">Names / Slogan</span>
      </h2>

      <div class="field">
        <label for="candidateName">Your Candidate Name</label>
        <input id="candidateName" type="text" placeholder="e.g. Alex Citizen" />
      </div>

      <div class="two-cols">
        <div class="col field">
          <label for="vpName">Vice President Name <span class="mini-note">(optional)</span></label>
          <input id="vpName" type="text" placeholder="e.g. Taylor Friend" />
        </div>
        <div class="col field">
          <label for="slogan">Campaign Slogan</label>
          <input id="slogan" type="text" placeholder="A Future For Everyone" />
        </div>
      </div>

      <div class="field">
        <label for="headlineMsg">Headline Message / Core Promise</label>
        <input id="headlineMsg" type="text" placeholder="Rebuild • Reunite • Rise" />
      </div>
    </section>

    <!-- PARTY + COLORS -->
    <section class="config-section">
      <h2>
        <span class="label">Party & Colors</span>
        <span class="sub">Header / Accent / Footer</span>
      </h2>

      <div class="field">
        <label for="partyPreset">Party Preset</label>
        <select id="partyPreset">
          <option value="dem">Democratic style</option>
          <option value="gop">Republican style</option>
          <option value="ind">Independent style</option>
          <option value="custom">Custom</option>
        </select>
      </div>

      <div class="field">
        <label for="partyName">Party / Movement Name</label>
        <input id="partyName" type="text" placeholder="Unity Party" />
      </div>

      <div class="two-cols">
        <div class="col field">
          <label for="color1">Header Color</label>
          <input id="color1" type="color" />
        </div>
        <div class="col field">
          <label for="color2">Accent Color (Issue Badges)</label>
          <input id="color2" type="color" />
        </div>
      </div>

      <div class="field">
        <label for="color3">Footer Color</label>
        <input id="color3" type="color" />
      </div>

      <p class="mini-note">
        Presets fill classic red / white / blue / green looks. Custom lets you pick anything.
      </p>
    </section>

    <!-- IMAGES -->
    <section class="config-section">
      <h2>
        <span class="label">Photos</span>
        <span class="sub">Optional</span>
      </h2>

      <div class="upload-row">
        <div class="titleline">Candidate Photo</div>
        <div class="mini-note">
          Square-ish looks best. Stored only in your browser/localStorage.
        </div>
        <input id="candidatePhoto" type="file" accept="image/*" />
      </div>

      <div class="upload-row">
        <div class="titleline">Vice President Photo</div>
        <div class="mini-note">
          Optional, also local only.
        </div>
        <input id="vpPhoto" type="file" accept="image/*" />
      </div>
    </section>

    <!-- POLICY POINTS -->
    <section class="config-section">
      <h2>
        <span class="label">Policy Points</span>
        <span class="sub">Pick or write</span>
      </h2>

      <div class="stance-row" data-stance-index="0">
        <div class="top">
          <select class="stancePresetSelect">
            <option value="jobs">Jobs & Wages</option>
            <option value="healthcare">Healthcare</option>
            <option value="education">Education</option>
            <option value="safety">Public Safety</option>
            <option value="custom">Custom Topic</option>
          </select>
          <input class="stanceCustomTitle" type="text" placeholder="Custom Topic Title" style="display:none;" />
        </div>
        <textarea class="stanceText"
          placeholder="I will raise wages, bring back manufacturing, and fight for working families."></textarea>
      </div>

      <div class="stance-row" data-stance-index="1">
        <div class="top">
          <select class="stancePresetSelect">
            <option value="jobs">Jobs & Wages</option>
            <option value="healthcare">Healthcare</option>
            <option value="education">Education</option>
            <option value="safety">Public Safety</option>
            <option value="custom">Custom Topic</option>
          </select>
          <input class="stanceCustomTitle" type="text" placeholder="Custom Topic Title" style="display:none;" />
        </div>
        <textarea class="stanceText"
          placeholder="Healthcare is a right. Lower costs, protect coverage, expand mental health care."></textarea>
      </div>

      <div class="stance-row" data-stance-index="2">
        <div class="top">
          <select class="stancePresetSelect">
            <option value="jobs">Jobs & Wages</option>
            <option value="healthcare">Healthcare</option>
            <option value="education">Education</option>
            <option value="safety">Public Safety</option>
            <option value="custom">Custom Topic</option>
          </select>
          <input class="stanceCustomTitle" type="text" placeholder="Custom Topic Title" style="display:none;" />
        </div>
        <textarea class="stanceText"
          placeholder="Stronger schools, safe classrooms, and real debt relief for students."></textarea>
      </div>
    </section>

    <!-- SAVE INFO -->
    <section class="config-section">
      <h2>
        <span class="label">Local Save</span>
        <span class="sub">Browser only</span>
      </h2>
      <p class="mini-note" style="margin:0 0 .5rem;">
        Your settings are auto-saved in this browser. Refreshing the site reloads them.
      </p>
      <button class="small" id="btnSaveNow">Save Now</button>
    </section>

    <!-- EXPORT INSTRUCTIONS -->
    <section class="config-section" style="margin-bottom:4rem;">
      <h2>
        <span class="label">How to Export</span>
        <span class="sub">Make PDF</span>
      </h2>
      <ol style="margin:0;padding-left:1rem;font-size:.7rem;line-height:1rem;color:var(--text-dim);">
        <li style="margin-bottom:.5rem;">Click <b>GO LIVE / PRINT VIEW</b>.</li>
        <li style="margin-bottom:.5rem;">You’ll see ONLY your poster, full page.</li>
        <li style="margin-bottom:.5rem;">Use browser menu → Print → “Save as PDF”.</li>
        <li>You’re done. You’re “running”.</li>
      </ol>
    </section>

  </aside>

  <!-- PREVIEW PANEL -->
  <section class="preview-wrapper">
    <div class="preview-title-bar">
      <div class="preview-title-left">
        <h2>Poster Preview</h2>
        <p>Live preview of the printed poster. (Scroll inside if it’s zoomed.)</p>
      </div>

      <div class="preview-title-right">
        <button class="primary small" id="btnPrintHint">Print Help</button>
        <div>
          Final print mode = white background, full Letter page, no editor.
        </div>
      </div>
    </div>

    <div class="poster-area-outer">
      <div class="poster" id="posterEdit">
        <!-- HEADER BAND -->
        <div class="poster-header" id="posterHeader">
          <div class="line-small">VOTE</div>
          <div class="line-big">
            <span id="candidateNameDisplay">YOUR NAME</span>
            &nbsp;FOR&nbsp;PRESIDENT
          </div>
        </div>

        <!-- BODY -->
        <div class="poster-body">
          <!-- LEFT: CANDIDATE -->
          <div class="body-left">
            <div class="candidate-pic" id="candidatePic"></div>
            <div class="candidate-name" id="candidateNameLower">YOUR NAME</div>
          </div>

          <!-- RIGHT: MESSAGE / STANCES / VP -->
          <div class="body-right">
            <div class="headline" id="headlineMsgDisplay">REBUILD • REUNITE • RISE</div>

            <div class="stances-list" id="stancesList">
              <!-- filled by JS -->
            </div>

            <div class="vp-box">
              <div class="vp-pic" id="vpPic"></div>
              <div class="vp-info">
                <div class="vp-role">VICE PRESIDENT</div>
                <div class="vp-name" id="vpNameDisplay">VICE NAME</div>
              </div>
            </div>
          </div>
        </div>

        <!-- FOOTER BAND -->
        <div class="poster-footer" id="posterFooter">
          <div class="footer-partyline" id="partyNameDisplay">UNITY PARTY</div>
          <div class="slogan" id="sloganDisplay">A FUTURE FOR EVERYONE</div>
          <div class="legal-note">
            Paid for by Citizens for <span id="legalNameDisplay">YOUR NAME</span>.
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- LIVE FULL PAGE POSTER (PRINT VIEW) -->
<div class="live-screen" id="liveScreen">
  <div class="live-toolbar">
    <button class="primary small" id="btnBrowserPrint">Print / Save PDF</button>
    <button class="danger small" id="btnExitLive">Exit Live</button>
    <div style="font-size:.7rem;line-height:.9rem;color:#fff;font-weight:400;max-width:400px;">
      Use “Print / Save PDF”. The black bar up here will NOT show on the PDF.
    </div>
  </div>

  <div class="live-frame">
    <!-- we clone posterEdit into posterLive so it’s 100% identical -->
    <div class="poster" id="posterLive"></div>
  </div>
</div>

<script>
/*
  LOCAL SAVE STRUCTURE
  Stored in localStorage key "youForPresidentConfig"
*/

const DEFAULT_STATE = {
  candidateName: "YOUR NAME",
  vpName: "VICE NAME",
  slogan: "A FUTURE FOR EVERYONE",
  headlineMsg: "REBUILD • REUNITE • RISE",
  partyPreset: "dem",
  partyName: "Unity Party",
  // color1 = header band
  // color2 = stance icon badges
  // color3 = footer band
  color1: "#1e3a8a", // blue
  color2: "#1e3a8a", // blue
  color3: "#b91c1c", // red footer
  candidatePhotoData: "",
  vpPhotoData: "",
  stances: [
    {
      topicPreset:"jobs",
      customTitle:"",
      text:"I will raise wages, bring back manufacturing, and fight for working families."
    },
    {
      topicPreset:"healthcare",
      customTitle:"",
      text:"Healthcare is a right. Lower costs, protect coverage, expand mental health care."
    },
    {
      topicPreset:"education",
      customTitle:"",
      text:"Stronger schools, safe classrooms, and real debt relief for students."
    }
  ]
};

let appState = loadState();

/*** DOM HOOKS ***/
const candidateNameInput   = document.getElementById("candidateName");
const vpNameInput          = document.getElementById("vpName");
const sloganInput          = document.getElementById("slogan");
const headlineMsgInput     = document.getElementById("headlineMsg");

const partyPresetSelect    = document.getElementById("partyPreset");
const partyNameInput       = document.getElementById("partyName");
const color1Input          = document.getElementById("color1");
const color2Input          = document.getElementById("color2");
const color3Input          = document.getElementById("color3");

const candidatePhotoInput  = document.getElementById("candidatePhoto");
const vpPhotoInput         = document.getElementById("vpPhoto");

const stanceRows           = Array.from(document.querySelectorAll(".stance-row"));

const candidateNameDisplay = document.getElementById("candidateNameDisplay");
const candidateNameLower   = document.getElementById("candidateNameLower");
const vpNameDisplay        = document.getElementById("vpNameDisplay");
const headlineMsgDisplay   = document.getElementById("headlineMsgDisplay");
const partyNameDisplay     = document.getElementById("partyNameDisplay");
const sloganDisplay        = document.getElementById("sloganDisplay");
const legalNameDisplay     = document.getElementById("legalNameDisplay");
const stancesList          = document.getElementById("stancesList");

const posterEdit           = document.getElementById("posterEdit");
const posterLive           = document.getElementById("posterLive");

const posterHeader         = document.getElementById("posterHeader");
const posterFooter         = document.getElementById("posterFooter");
const candidatePic         = document.getElementById("candidatePic");
const vpPic                = document.getElementById("vpPic");

const btnGoLive            = document.getElementById("btnGoLive");
const liveScreen           = document.getElementById("liveScreen");
const btnExitLive          = document.getElementById("btnExitLive");
const btnBrowserPrint      = document.getElementById("btnBrowserPrint");
const btnPrintHint         = document.getElementById("btnPrintHint");
const btnSaveNow           = document.getElementById("btnSaveNow");
const btnClear             = document.getElementById("btnClear");

/*** STORAGE HELPERS ***/
function loadState() {
  try {
    const txt = localStorage.getItem("youForPresidentConfig");
    if (!txt) return structuredClone(DEFAULT_STATE);
    const parsed = JSON.parse(txt);
    return deepMerge(structuredClone(DEFAULT_STATE), parsed);
  } catch(e){
    return structuredClone(DEFAULT_STATE);
  }
}

function saveState() {
  localStorage.setItem("youForPresidentConfig", JSON.stringify(appState));
}

function deepMerge(base, override){
  if (Array.isArray(base) && Array.isArray(override)){
    const out = base.map((v,i)=> {
      if (i < override.length){
        return deepMerge(v, override[i]);
      } else {
        return structuredClone(v);
      }
    });
    for (let j=base.length;j<override.length;j++){
      out.push(structuredClone(override[j]));
    }
    return out;
  } else if (isObj(base) && isObj(override)){
    const out = {};
    const keys = new Set([...Object.keys(base),...Object.keys(override)]);
    keys.forEach(k=>{
      if (k in base && k in override){
        out[k] = deepMerge(base[k], override[k]);
      } else if (k in override){
        out[k] = structuredClone(override[k]);
      } else {
        out[k] = structuredClone(base[k]);
      }
    });
    return out;
  } else {
    return structuredClone(override);
  }
}
function isObj(v){
  return v && typeof v==="object" && !Array.isArray(v);
}

/*** RENDER POSTER FROM STATE ***/
function renderPoster(){
  // names / text
  candidateNameDisplay.textContent = appState.candidateName || "YOUR NAME";
  candidateNameLower.textContent   = appState.candidateName || "YOUR NAME";
  vpNameDisplay.textContent        = appState.vpName || "VICE NAME";
  headlineMsgDisplay.textContent   = appState.headlineMsg || "REBUILD • REUNITE • RISE";
  sloganDisplay.textContent        = appState.slogan || "A FUTURE FOR EVERYONE";
  partyNameDisplay.textContent     = appState.partyName || "Unity Party";
  legalNameDisplay.textContent     = appState.candidateName || "YOUR NAME";

  // header / footer color
  posterHeader.style.background = appState.color1 || "#1e3a8a";
  posterHeader.style.color      = pickGoodTextColor(appState.color1 || "#1e3a8a");

  posterFooter.style.background = appState.color3 || "#b91c1c";
  posterFooter.style.color      = pickGoodTextColor(appState.color3 || "#b91c1c");

  // candidate photo
  if (appState.candidatePhotoData) {
    candidatePic.style.backgroundImage = `url(${appState.candidatePhotoData})`;
    candidatePic.style.backgroundColor = "transparent";
  } else {
    candidatePic.style.backgroundImage = "none";
    candidatePic.style.backgroundColor = "#ddd";
  }

  // vp photo
  if (appState.vpPhotoData) {
    vpPic.style.backgroundImage = `url(${appState.vpPhotoData})`;
    vpPic.style.backgroundColor = "transparent";
  } else {
    vpPic.style.backgroundImage = "none";
    vpPic.style.backgroundColor = "#ddd";
  }

  // stances
  stancesList.innerHTML = "";
  appState.stances.forEach((stance, idx)=>{
    const topicName = stanceTopicName(stance);

    const item = document.createElement("div");
    item.className = "stance-item";

    const icon = document.createElement("div");
    icon.className = "stance-icon";
    icon.style.background = appState.color2 || "#1e3a8a";
    icon.style.color      = pickGoodTextColor(appState.color2 || "#1e3a8a");
    icon.textContent      = (idx+1).toString();

    const txtWrap = document.createElement("div");
    txtWrap.className = "stance-text";

    const titleEl = document.createElement("div");
    titleEl.className = "stance-title";
    titleEl.textContent = topicName.toUpperCase();

    const descEl = document.createElement("div");
    descEl.className = "stance-desc";
    descEl.textContent = stance.text || "";

    txtWrap.appendChild(titleEl);
    txtWrap.appendChild(descEl);

    item.appendChild(icon);
    item.appendChild(txtWrap);
    stancesList.appendChild(item);
  });
}

/*** CONTRAST HELPER ***/
function pickGoodTextColor(bgHex){
  const c = hexToRgb(bgHex || "#000000");
  const luminance = (0.299*c.r + 0.587*c.g + 0.114*c.b)/255;
  return (luminance > 0.5) ? "#000" : "#fff";
}
function hexToRgb(hex){
  let h = hex.replace("#","");
  if (h.length===3){
    h = h[0]+h[0]+h[1]+h[1]+h[2]+h[2];
  }
  const r = parseInt(h.slice(0,2),16);
  const g = parseInt(h.slice(2,4),16);
  const b = parseInt(h.slice(4,6),16);
  return {r,g,b};
}

/*** STANCE TOPIC NAME ***/
function stanceTopicName(stance){
  if (stance.topicPreset==="custom" && stance.customTitle.trim()!==""){
    return stance.customTitle.trim();
  }
  switch(stance.topicPreset){
    case "jobs": return "Jobs & Wages";
    case "healthcare": return "Healthcare";
    case "education": return "Education";
    case "safety": return "Public Safety";
    default: return "Your Issue";
  }
}

/*** SYNC STATE FROM INPUTS ***/
function syncFromInputs(){
  appState.candidateName = candidateNameInput.value.trim() || "";
  appState.vpName        = vpNameInput.value.trim()        || "";
  appState.slogan        = sloganInput.value.trim()        || "";
  appState.headlineMsg   = headlineMsgInput.value.trim()   || "";
  appState.partyPreset   = partyPresetSelect.value;
  appState.partyName     = partyNameInput.value.trim()     || "";
  appState.color1        = color1Input.value;
  appState.color2        = color2Input.value;
  appState.color3        = color3Input.value;

  stanceRows.forEach((row, idx)=>{
    const presetSel = row.querySelector(".stancePresetSelect");
    const customIn  = row.querySelector(".stanceCustomTitle");
    const txtArea   = row.querySelector(".stanceText");
    if (!appState.stances[idx]){
      appState.stances[idx] = {
        topicPreset:"custom",
        customTitle:"",
        text:""
      };
    }
    appState.stances[idx].topicPreset = presetSel.value;
    appState.stances[idx].customTitle = customIn.value;
    appState.stances[idx].text        = txtArea.value;
  });

  saveState();
  renderPoster();
  clonePosterToLive();
}

/*** PRESET COLORS ***/
function applyPresetColors(preset){
  if (preset==="dem"){
    // blue header / blue accents / red footer
    appState.color1 = "#1e3a8a"; // header
    appState.color2 = "#1e3a8a"; // badges
    appState.color3 = "#b91c1c"; // footer
    appState.partyName = "Democratic Party";
  } else if (preset==="gop"){
    // red header / red badges / blue footer
    appState.color1 = "#b91c1c";
    appState.color2 = "#b91c1c";
    appState.color3 = "#1e3a8a";
    appState.partyName = "Republican Party";
  } else if (preset==="ind"){
    // green header / green badges / green footer
    appState.color1 = "#14532d";
    appState.color2 = "#14532d";
    appState.color3 = "#14532d";
    appState.partyName = "Independent";
  } else {
    // custom -> don't auto override user picks
    return;
  }

  color1Input.value = appState.color1;
  color2Input.value = appState.color2;
  color3Input.value = appState.color3;
  partyNameInput.value = appState.partyName;
}

/*** IMAGE UPLOAD TO BASE64 ***/
function handleImageUpload(fileInputEl, targetKey){
  const file = fileInputEl.files && fileInputEl.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = (ev)=>{
    appState[targetKey] = ev.target.result;
    saveState();
    renderPoster();
    clonePosterToLive();
  };
  reader.readAsDataURL(file);
}

/*** CLONE POSTER INTO LIVE VIEW ***/
function clonePosterToLive(){
  posterLive.innerHTML = posterEdit.innerHTML;

  // sync inline backgrounds for candidate/vp pics in cloned poster
  const editCand = posterEdit.querySelector("#candidatePic");
  const liveCand = posterLive.querySelector("#candidatePic");
  if (editCand && liveCand){
    liveCand.style.backgroundImage = editCand.style.backgroundImage;
    liveCand.style.backgroundColor = editCand.style.backgroundColor;
  }

  const editVp = posterEdit.querySelector("#vpPic");
  const liveVp = posterLive.querySelector("#vpPic");
  if (editVp && liveVp){
    liveVp.style.backgroundImage = editVp.style.backgroundImage;
    liveVp.style.backgroundColor = editVp.style.backgroundColor;
  }

  // sync header/footer bg + text colors
  const editHeader = posterEdit.querySelector("#posterHeader");
  const liveHeader = posterLive.querySelector("#posterHeader");
  if (editHeader && liveHeader){
    liveHeader.style.background = editHeader.style.background;
    liveHeader.style.color      = editHeader.style.color;
  }

  const editFooter = posterEdit.querySelector("#posterFooter");
  const liveFooter = posterLive.querySelector("#posterFooter");
  if (editFooter && liveFooter){
    liveFooter.style.background = editFooter.style.background;
    liveFooter.style.color      = editFooter.style.color;
  }

  // also stance-icons colors
  const editIcons = posterEdit.querySelectorAll(".stance-icon");
  const liveIcons = posterLive.querySelectorAll(".stance-icon");
  liveIcons.forEach((icon, i)=>{
    if (editIcons[i]){
      icon.style.background = editIcons[i].style.background;
      icon.style.color      = editIcons[i].style.color;
    }
  });
}

/*** INPUT EVENT WIRING ***/
candidateNameInput.addEventListener("input", syncFromInputs);
vpNameInput.addEventListener("input", syncFromInputs);
sloganInput.addEventListener("input", syncFromInputs);
headlineMsgInput.addEventListener("input", syncFromInputs);

partyPresetSelect.addEventListener("change", ()=>{
  appState.partyPreset = partyPresetSelect.value;
  if (appState.partyPreset!=="custom"){
    applyPresetColors(appState.partyPreset);
  }
  syncFromInputs();
});

partyNameInput.addEventListener("input", syncFromInputs);
color1Input.addEventListener("input", syncFromInputs);
color2Input.addEventListener("input", syncFromInputs);
color3Input.addEventListener("input", syncFromInputs);

candidatePhotoInput.addEventListener("change", ()=>{
  handleImageUpload(candidatePhotoInput,"candidatePhotoData");
});
vpPhotoInput.addEventListener("change", ()=>{
  handleImageUpload(vpPhotoInput,"vpPhotoData");
});

stanceRows.forEach((row)=>{
  const presetSel = row.querySelector(".stancePresetSelect");
  const customIn  = row.querySelector(".stanceCustomTitle");
  const txtArea   = row.querySelector(".stanceText");

  presetSel.addEventListener("change", ()=>{
    if (presetSel.value==="custom"){
      customIn.style.display="";
    } else {
      customIn.style.display="none";
    }
    syncFromInputs();
  });

  customIn.addEventListener("input", syncFromInputs);
  txtArea.addEventListener("input", syncFromInputs);
});

/*** LIVE MODE TOGGLE ***/
btnGoLive.addEventListener("click", ()=>{
  clonePosterToLive();
  liveScreen.style.display="flex";
  window.scrollTo({top:0,behavior:"instant"});
});

btnExitLive.addEventListener("click", ()=>{
  liveScreen.style.display="none";
});

btnBrowserPrint.addEventListener("click", ()=>{
  window.print();
});

btnPrintHint.addEventListener("click", ()=>{
  alert(
`How to export:

1. Click "GO LIVE / PRINT VIEW".
2. You'll see ONLY your poster on a white page.
3. Click "Print / Save PDF".
4. Pick "Save as PDF".
5. Done.`
  );
});

/*** SAVE NOW BUTTON ***/
btnSaveNow.addEventListener("click", ()=>{
  saveState();
  alert("Saved in your browser. Reload will restore.");
});

/*** CLEAR EVERYTHING BUTTON ***/
btnClear.addEventListener("click", ()=>{
  if (!confirm("This will wipe everything and reload defaults.\nAre you sure?")) return;
  appState = structuredClone(DEFAULT_STATE);
  applyStateToInputs();
  saveState();
  renderPoster();
  clonePosterToLive();
});

/*** PUSH STATE INTO FORM FIELDS (ON LOAD) ***/
function applyStateToInputs(){
  candidateNameInput.value = appState.candidateName;
  vpNameInput.value        = appState.vpName;
  sloganInput.value        = appState.slogan;
  headlineMsgInput.value   = appState.headlineMsg;

  partyPresetSelect.value  = appState.partyPreset;
  partyNameInput.value     = appState.partyName;

  color1Input.value        = appState.color1;
  color2Input.value        = appState.color2;
  color3Input.value        = appState.color3;

  stanceRows.forEach((row, idx)=>{
    const presetSel = row.querySelector(".stancePresetSelect");
    const customIn  = row.querySelector(".stanceCustomTitle");
    const txtArea   = row.querySelector(".stanceText");

    const st = appState.stances[idx] || {
      topicPreset:"custom",
      customTitle:"",
      text:""
    };

    presetSel.value = st.topicPreset;
    txtArea.value   = st.text;
    customIn.value  = st.customTitle;
    if (st.topicPreset==="custom"){
      customIn.style.display="";
    } else {
      customIn.style.display="none";
    }
  });
}

/*** INIT ***/
applyStateToInputs();
renderPoster();
clonePosterToLive();
</script>

</body>
</html>
